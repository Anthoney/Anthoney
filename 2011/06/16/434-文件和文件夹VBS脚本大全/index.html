<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="From to Earth - 小事成就大事,细节成就完美"><title>文件和文件夹VBS脚本大全 | From to Earth</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/latest/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/grids-responsive-min.min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/latest/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script src="https://www.googletagmanager.com/gtag/js?id=UA-14722977-1" async></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-14722977-1');
</script><script type="text/javascript" src="//lib.baomitu.com/clipboard.js/latest/clipboard.min.js"></script><script type="text/javascript" src="//lib.baomitu.com/toastr.js/latest/toastr.min.js"></script><link rel="stylesheet" href="//lib.baomitu.com/toastr.js/latest/toastr.min.css"><div class="darkmode-toggle">🌓</div><script>var prefersDarkMode = window.matchMedia('(prefers-color-scheme: dark)');
var toggle = document.querySelector('.darkmode-toggle');
var html = document.querySelector('html');

html.dataset.dark = localStorage.dark || prefersDarkMode.matches;

toggle.addEventListener('click', () => {
localStorage.dark = !(html.dataset.dark == 'true');
html.dataset.dark = localStorage.dark;
});</script><meta name="generator" content="Hexo 6.3.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">文件和文件夹VBS脚本大全</h1><a id="logo" href="/.">From to Earth</a><p class="description">小事成就大事,细节成就完美</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">文件和文件夹VBS脚本大全</h1><div class="post-meta">2011-06-16<span> | </span><span class="category"><a href="/categories/%E8%BD%AF%E4%BB%B6%E6%8A%80%E6%9C%AF/">软件技术</a></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 3.7k</span><span class="post-meta-item-text"> 字</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i><span class="post-count"> 18</span><span class="post-meta-item-text"> 分钟</span></span></span></div><div class="post-content"><p>文件和文件夹vbs脚本大全枚举文件夹中的所有文件<br />描述<br />返回 Scripts 文件夹中所有文件的列表。如果计算机有多个文件夹（例如C:\Scripts 和 D:\Scripts），则文件将从这些文件夹中的每一个返回。<br />脚本代码<br />strComputer &#x3D; “.”<br />Set objWMIService &#x3D; GetObject(“winmgmts:” _<br />&nbsp;&nbsp;&nbsp;&nbsp;&amp; “{impersonationLevel&#x3D;impersonate}!\“ &amp; strComputer <br />&amp; “\root\cimv2”)<br />Set colFiles &#x3D; objWMIService. _<br />&nbsp;&nbsp;&nbsp;&nbsp;ExecQuery(“Sel&#101;ct * from CIM_DataFile wh&#101;re Path &#x3D; <br />‘\Scripts\‘“)<br />For Each objFile in colFiles<br />&nbsp;&nbsp;&nbsp;&nbsp;Wscript.Echo objFile.Name <br />Next<br /><br />移动文件<br />描述<br />演示脚本使用 FileSystermObject 将文件从一个位置移到另一个位置。此脚本必须运行在本地计算机上。<br />脚本代码 <br />Set objFSO &#x3D; Cr&#101;ateObject(“Scripting.FileSystemObject”)<br />objFSO.MoveFile “C:\FSO\ScriptLog.log” , “D:\Archive”<br /><br />通过日期查找文件夹<br />描述<br />查找在 2002 年 3 月 1 日之后创建的所有文件。要修改此脚本，您必须修改赋给变量 dtmTargetDate 的值中的下列项：<br />?<br />2002 – 将此项更改为目标年（如 1999）。<br />?<br />03–将此项更改为目标月（01 代表 1 月、 02代表 2月……12 代表 12月）<br />?<br />01 – 将此项更改为目标天（01 代表该月的第一天、02 代表第二天）。<br />?<br />-420 – 为了确保具有正确的结果，可以将此项更改为您所在的时区和格林尼治标准时间之间的偏移量。如果您不知道此偏移量，可以使用脚本确定与格林尼治标准时间的时区偏移量。<br />脚本代码 <br />On Error Resume Next<br />dtmTargetDate &#x3D; “20020301000000.000000-420”<br />strComputer &#x3D; “.”<br />Set objWMIService &#x3D; GetObject _<br />&nbsp;&nbsp;&nbsp;&nbsp;(“winmgmts:” &amp; “!\“ &amp; strComputer &amp; “\root\cimv2”)<br />Set colFolders &#x3D; objWMIService.ExecQuery _<br />&nbsp;&nbsp;&nbsp;&nbsp;(“Sel&#101;ct * from Win32_Directory Wh&#101;re CreationDate &gt; <br />‘“ &amp; _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dtmtargetDate &amp; “‘“)<br />For Each objFolder in colFolders<br />&nbsp;&nbsp;&nbsp;&nbsp;Wscript.Echo objFolder.Name <br />Next<br /><br />逐个字符地读取文本文件<br />描述<br />演示脚本使用 FileSystemObject 逐个字符地读取文本文件，并分别将这些字符显示在屏幕上。此脚本必须运行在本地计算机上。<br />脚本代码<br />Set objFSO &#x3D; Cr&#101;ateObject(“Scripting.FileSystemObject”)<br />Set objFile &#x3D; objFSO.OpenTextFile(“C:\FSO\New Text <br />Document.txt”, 1)<br />Do Until objFile.AtEndOfStream<br />&nbsp;&nbsp;&nbsp;&nbsp;strCharacters &#x3D; objFile.Read(1)<br />&nbsp;&nbsp;&nbsp;&nbsp;Wscript.Echo strCharacters<br />Loop<br /><br />识别 Shell 对象动词<br />描述<br />为 Recycle Bin 返回 Shell 对象动词（上下文菜单项）的列表。<br />脚本代码<br />Const RECYCLE_BIN &#x3D; &amp;Ha&amp;<br />Set objShell &#x3D; Cr&#101;ateObject(“Shell.Application”)<br />Set objFolder &#x3D; objShell.NameSpace(RECYCLE_BIN) <br />Set objFolderItem &#x3D; objFolder.Self <br />Set colVerbs &#x3D; objFolderItem.Verbs<br />For i &#x3D; 0 to colVerbs.Count - 1<br />&nbsp;&nbsp;&nbsp;&nbsp;Wscript.Echo colVerbs.Item(i)<br />Next<br /><br />生成文件名<br />描述<br />演示脚本使用 FileSystemObject 的 GetTempName 方法生成随机文件名。此脚本必须运行在本地计算机上。<br />脚本代码<br />Set objFSO &#x3D; Cr&#101;ateObject(“Scripting.FileSystemObject”)<br />For i &#x3D; 1 to 10<br />&nbsp;&nbsp;&nbsp;&nbsp;strTempFile &#x3D; objFSO.GetTempName<br />&nbsp;&nbsp;&nbsp;&nbsp;Wscript.Echo strTempFile<br />Next<br /><br />创建和命名文本文件<br />描述<br />演示脚本使用 FileSystemObject 的 GetTempName 方法生成一个文件名，然后根据该名称创建一个文件。<br />脚本代码<br />Set objFSO &#x3D; Cr&#101;ateObject(“Scripting.FileSystemObject”)<br />strPath &#x3D; “C:\FSO”<br />strFileName &#x3D; objFSO.GetTempName<br />strFullName &#x3D; objFSO.BuildPath(strPath, strFileName)<br />Set objFile &#x3D; objFSO.Cr&#101;ateTextFile(strFullName)<br />objFile.Close<br />objFSO.Del&#101;teFile(strFullName)<br /><br />创建网络共享<br />描述<br />创建一个名为 FinanceShare 的共享文件夹，将同时连接的最大数量设置为25，然后添加共享描述。<br />脚本代码<br />Const FILE_SHARE &#x3D; 0<br />Const MAXIMUM_CONNECTIONS &#x3D; 25<br />strComputer &#x3D; “.”<br />Set objWMIService &#x3D; GetObject(“winmgmts:” _<br />&nbsp;&nbsp;&nbsp;&nbsp;&amp; “{impersonationLevel&#x3D;impersonate}!\“ &amp; strComputer <br />&amp; “\root\cimv2”)<br />Set objNewShare &#x3D; objWMIService.Get(“Win32_Share”)<br />errReturn &#x3D; objNewShare.Cr&#101;ate _<br />&nbsp;&nbsp;&nbsp;&nbsp;(“C:\Finance”, “FinanceShare”, FILE_SHARE, _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MAXIMUM_CONNECTIONS, “Public share for the Finance <br />group.”)<br />Wscript.Echo errReturn<br /><br />创建文本文件<br />描述<br />演示脚本创建一个新的空文本文件。此脚本必须运行在本地计算机上。<br />脚本代码<br />Set objFSO &#x3D; Cr&#101;ateObject(“Scripting.FileSystemObject”)<br />Set objFile &#x3D; objFSO.Cr&#101;ateTextFile(“C:\FSO\ScriptLog.txt”)<br /><br />创建文件夹<br />描述<br />演示脚本使用 FileSystemObject 创建一个文件夹。此脚本必须运行在本地计算机上。<br />脚本代码<br />Set objFSO &#x3D; Cr&#101;ateObject(“Scripting.FileSystemObject”)<br />Set objFolder &#x3D; objFSO.Cr&#101;ateFolder(“C:\FSO”)<br /><br />发布共享文件夹<br />描述<br />在 Active Directory 中发布共享文件夹，给该文件夹指派一个描述和三个关键字。<br />脚本代码<br />Set objComputer &#x3D; GetObject _<br />&nbsp;&nbsp;&nbsp;&nbsp;(“LDAP:&#x2F;&#x2F;OU&#x3D;Finance, DC&#x3D;fabrikam, DC&#x3D;com”)<br />Set objShare &#x3D; objComputer.Cr&#101;ate(“volume”, <br />“CN&#x3D;FinanceShare”)<br />objShare.Put “uNCName”, “<a href="http://www.from2.net/file://atl-dc-02/FinanceShare" rel="external" target="_blank">\atl-dc-02\FinanceShare</a>“<br />objShare.Put “Description”, “Public share for users in the <br />Finance group.”<br />objShare.Put “Keywords”, Array(“finance”, “fiscal”, <br />“monetary”) <br />objShare.SetInfo<br /><br />在文件上执行操作<br />描述<br />使用 Shell 对象打印 C:\Logs 文件夹中的所有文件。<br />脚本代码 <br />TargetFolder &#x3D; “C:\Logs” <br />Set objShell &#x3D; Cr&#101;ateObject(“Shell.Application”)<br />Set objFolder &#x3D; objShell.Namespace(TargetFolder) <br />Set colItems &#x3D; objFolder.Items<br />For i &#x3D; 0 to colItems.Count - 1<br />&nbsp;&nbsp;&nbsp;&nbsp;colItems.Item(i).InvokeVerbEx(“Print”)<br />Next<br /><br />按照从下到上的顺序读取文本文件<br />描述<br />演示脚本使用 FileSystemObject 读取一个文本文件，并以相反的顺序显示该文本文件（即从最后一行开始，以第一行结束）。<br />脚本代码 <br />Dim arrFileLines()<br />i &#x3D; 0<br />Set objFSO &#x3D; Cr&#101;ateObject(“Scripting.FileSystemObject”)<br />Set objFile &#x3D; objFSO.OpenTextFile(“C:\FSO\ScriptLog.txt”, <br />1)<br />Do Until objFile.AtEndOfStream<br />&nbsp;&nbsp;&nbsp;&nbsp;Redim Preserve arrFileLines(i)<br />&nbsp;&nbsp;&nbsp;&nbsp;arrFileLines(i) &#x3D; objFile.ReadLine<br />&nbsp;&nbsp;&nbsp;&nbsp;i &#x3D; i + 1<br />Loop<br />objFile.Close<br />For l &#x3D; Ubound(arrFileLines) to LBound(arrFileLines) Step <br />-1<br />&nbsp;&nbsp;&nbsp;&nbsp;Wscript.Echo arrFileLines(l)<br />Next<br /><br />创建新文件夹<br />描述<br />使用 Shell 对象创建名为 C:\Archive 的新文件夹。<br />脚本代码 <br />ParentFolder &#x3D; “C:&quot; <br />set objShell &#x3D; Cr&#101;ateObject(“Shell.Application”)<br />set objFolder &#x3D; objShell.NameSpace(ParentFolder) <br />objFolder.NewFolder “Archive”<br /><br />监视文件修改<br />描述<br />任何时候修改文件 C:\Scripts\Index.vb，临时事件消费程序都会发出警告。最好运行在 Cscript.exe 下。<br />脚本代码 <br />strComputer &#x3D; “.”<br />Set objWMIService &#x3D; GetObject(“winmgmts:” _<br />&nbsp;&nbsp;&nbsp;&nbsp;&amp; “{impersonationLevel&#x3D;impersonate}!\“ &amp; _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strComputer &amp; “\root\cimv2”)<br />Set colMonitoredEvents &#x3D; <br />objWMIService.ExecNotificationQuery _<br />&nbsp;&nbsp;&nbsp;&nbsp;(“Sel&#101;ct * FROM __InstanceModificationEvent WITHIN 10 <br />Wh&#101;re “ _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp; “TargetInstance ISA ‘CIM_DataFile’ and “ _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp; “TargetInstance.Name&#x3D;’c:\scripts\index.vbs’”)<br />Do<br />&nbsp;&nbsp;&nbsp;&nbsp;Set objLatestEvent &#x3D; colMonitoredEvents.NextEvent<br />&nbsp;&nbsp;&nbsp;&nbsp;Wscript.Echo “File: “ &amp; <br />objLatestEvent.TargetInstance.Name<br />&nbsp;&nbsp;&nbsp;&nbsp;Wscript.Echo “New size: “ &amp; <br />objLatestEvent.TargetInstance.FileSize<br />&nbsp;&nbsp;&nbsp;&nbsp;Wscript.Echo “Old size: “ &amp; <br />objLatestEvent.PreviousInstance.FileSize<br />Loop<br /><br />监视文件删除<br />描述<br />任何时候从 C:\Scripts 文件夹删除文件，临时事件消费程序都会发出警告。最好运行在 Cscript.exe 下。<br />脚本代码 <br />strComputer &#x3D; “.”<br />Set objWMIService &#x3D; GetObject(“winmgmts:” _<br />&nbsp;&nbsp;&nbsp;&nbsp;&amp; “{impersonationLevel&#x3D;impersonate}!\“ &amp; _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strComputer &amp; “\root\cimv2”)<br />Set colMonitoredEvents &#x3D; <br />objWMIService.ExecNotificationQuery _<br />&nbsp;&nbsp;&nbsp;&nbsp;(“Sel&#101;ct * FROM __InstanceDeletionEvent WITHIN 10 Wh&#101;re <br />“ _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp; “Targetinstance ISA ‘CIM_DirectoryContainsFile’ <br />and “ _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp; “TargetInstance.GroupComp’Win32_Directory.Name&#x3D;””c:\\scripts””‘“)<br />Do<br />&nbsp;&nbsp;&nbsp;&nbsp;Set objLatestEvent &#x3D; colMonitoredEvents.NextEvent<br />&nbsp;&nbsp;&nbsp;&nbsp;Wscript.Echo <br />objLatestEvent.TargetInstance.PartComponent<br />Loop<br /><br />复制文件夹<br />描述<br />演示脚本使用 FileSystemObject 将文件夹复制到新的位置。此脚本必须运行在本地计算机上。<br />脚本代码<br />Const OverWriteFiles &#x3D; True<br />Set objFSO &#x3D; Cr&#101;ateObject(“Scripting.FileSystemObject”)<br />objFSO.CopyFolder “C:\Scripts” , “C:\FSO” , OverWriteFiles<br /><br />监视文件创建<br />描述<br />任何时候在 C:\Scripts 文件夹中创建文件，临时事件消费程序就发出警告。最好在 Cscript.exe 下运行。<br />脚本代码 <br />strComputer &#x3D; “.”<br />Set objWMIService &#x3D; GetObject(“winmgmts:” _<br />&nbsp;&nbsp;&nbsp;&nbsp;&amp; “{impersonationLevel&#x3D;impersonate}!\“ &amp; _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strComputer &amp; “\root\cimv2”)<br />Set colMonitoredEvents &#x3D; <br />objWMIService.ExecNotificationQuery _<br />(“Sel&#101;ct * FROM __InstanceCreationEvent WITHIN 10 Wh&#101;re “ _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp; “Targetinstance ISA ‘CIM_DirectoryContainsFile’ <br />and “ _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp; “TargetInstance.GroupComp’Win32_Directory.Name&#x3D;””c:\\scripts””‘“)<br />Do<br />&nbsp;&nbsp;&nbsp;&nbsp;Set objLatestEvent &#x3D; colMonitoredEvents.NextEvent<br />&nbsp;&nbsp;&nbsp;&nbsp;Wscript.Echo <br />objLatestEvent.TargetInstance.PartComponent<br />Loop<br /><br />复制文件<br />描述<br />演示脚本使用 FileSystemObject 来复制文件。此脚本必须运行在本地计算机上。<br />脚本代码<br />Const OverwriteExisting &#x3D; True<br />Set objFSO &#x3D; Cr&#101;ateObject(“Scripting.FileSystemObject”)<br />objFSO.CopyFile “C:\FSO\ScriptLog.txt” , “D:\Archive&quot;, <br />OverwriteExisting<br /><br />复制文件集<br />描述<br />演示脚本使用 FileSystemObject 将文件夹中的所有 .txt 文件复制到一个新的位置。<br />脚本代码<br />Const OverwriteExisting &#x3D; True<br />Set objFSO &#x3D; Cr&#101;ateObject(“Scripting.FileSystemObject”)<br />objFSO.CopyFile “C:\FSO*.txt” , “D:\Archive&quot; , <br />OverwriteExisting<br /><br />解析路径名<br />描述<br />演示脚本使用 FileSystemObject 临时返回路径名信息，其中包括文件名、文件扩展名、完整文件路径等等。此脚本必须运行在本地计算机上。<br />脚本代码 <br />Set objFSO &#x3D; Cr&#101;ateObject(“Scripting.FileSystemObject”)<br />Set objFile &#x3D; objFSO.GetFile(“ScriptLog.txt”)<br />Wscript.Echo “Absolute path: “ &amp; <br />objFSO.GetAbsolutePathName(objFile)<br />Wscript.Echo “Parent folder: “ &amp; <br />objFSO.GetParentFolderName(objFile) <br />Wscript.Echo “File name: “ &amp; objFSO.GetFileName(objFile)<br />Wscript.Echo “Base name: “ &amp; objFSO.GetBaseName(objFile)<br />Wscript.Echo “Extension name: “ &amp; <br />objFSO.GetExtensionName(objFile)<br /><br />将文本文件读入数组<br />描述<br />演示代码使用 VBScript Split 命令从逗号分隔的值文件读取一行，然后将该行中的各个项放入一个数组。<br />脚本代码 <br />Const ForReading &#x3D; 1<br />Set objFSO &#x3D; Cr&#101;ateObject(“Scripting.FileSystemObject”)<br />Set objTextFile &#x3D; objFSO.OpenTextFile _<br />&nbsp;&nbsp;&nbsp;&nbsp;(“c:\scripts\servers and services.txt”, ForReading)<br />Do Until objTextFile.AtEndOfStream<br />&nbsp;&nbsp;&nbsp;&nbsp;strNextLine &#x3D; objTextFile.Readline<br />&nbsp;&nbsp;&nbsp;&nbsp;arrServiceList &#x3D; Split(strNextLine , “,”)<br />&nbsp;&nbsp;&nbsp;&nbsp;Wscript.Echo “Server name: “ &amp; arrServiceList(0)<br />&nbsp;&nbsp;&nbsp;&nbsp;For i &#x3D; 1 to Ubound(arrServiceList)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Wscript.Echo “Service: “ &amp; arrServiceList(i)<br />&nbsp;&nbsp;&nbsp;&nbsp;Next<br />Loop<br /><br />解压缩文件夹<br />描述 解压缩文件夹 C:\Scripts。<br />脚本代码 <br />strComputer &#x3D; “.”<br />Set objWMIService &#x3D; GetObject(“winmgmts:” _<br />&nbsp;&nbsp;&nbsp;&nbsp;&amp; “{impersonationLevel&#x3D;impersonate}!\“ &amp; strComputer <br />&amp; “\root\cimv2”)<br />Set colFolders &#x3D; objWMIService.ExecQuery _<br />&nbsp;&nbsp;&nbsp;&nbsp;(“Sel&#101;ct * from Win32_Directory wh&#101;re name &#x3D; <br />‘c:\Scripts’”)<br />For Each objFolder in colFolders<br />&nbsp;&nbsp;&nbsp;&nbsp;errResults &#x3D; objFolder.Uncompress<br />&nbsp;&nbsp;&nbsp;&nbsp;Wscript.Echo errResults<br />Next<br /><br />将网络共享映射到本地文件夹<br />描述<br />使用查询的 WMI Associators 返回计算机上所有网络共享的本地路径。<br />脚本代码 <br />strComputer &#x3D; “.”<br />Set objWMIService &#x3D; GetObject(“winmgmts:” _<br />&nbsp;&nbsp;&nbsp;&nbsp;&amp; “{impersonationLevel&#x3D;impersonate}!\“ &amp; strComputer <br />&amp; “\root\cimv2”)<br />Set colShares &#x3D; objWMIService.ExecQuery <em><br />&nbsp;&nbsp;&nbsp;&nbsp;(“Associators of {Win32_Share.Name&#x3D;’Scripts’} Wh&#101;re “ <br /></em><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp; “AssocClass&#x3D;Win32_ShareToDirectory”)<br />For Each objFolder in colShares<br />&nbsp;&nbsp;&nbsp;&nbsp;Wscript.Echo objFolder.Name<br />Next<br /><br />将所有的网络共享映射到本地文件夹<br />描述<br />使用查询的 WMI Associators 返回名为 Scripts 的网络共享的本地路径。<br />脚本代码<br />strComputer &#x3D; “.”<br />Set objWMIService &#x3D; GetObject(“winmgmts:” _<br />&nbsp;&nbsp;&nbsp;&nbsp;&amp; “{impersonationLevel&#x3D;impersonate}!\“ &amp; strComputer <br />&amp; “\root\cimv2”)<br />Set colShares &#x3D; objWMIService.ExecQuery _<br />&nbsp;&nbsp;&nbsp;&nbsp;(“Sel&#101;ct * From Win32_Share”)<br />For Each objShare in colShares<br />&nbsp;&nbsp;&nbsp;&nbsp;Set colAssociations &#x3D; objWMIService.ExecQuery _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(“Associators of {Win32_Share.Name&#x3D;’” &amp; <br />objShare.Name &amp; “‘} “ _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp; “ Wh&#101;re AssocClass&#x3D;Win32_ShareToDirectory”)<br />&nbsp;&nbsp;&nbsp;&nbsp;For Each objFolder in colAssociations<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Wscript.Echo objShare.Name &amp; vbTab &amp; objFolder.Name<br />&nbsp;&nbsp;&nbsp;&nbsp;Next<br />Next<br /><br />枚举文件夹属性<br />描述<br />演示脚本使用 FileSystemObject 枚举文件夹的属性。此脚本必须运行在本地计算机上。<br />脚本代码<br />Set objFSO &#x3D; Cr&#101;ateObject(“Scripting.FileSystemObject”)<br />Set objFolder &#x3D; objFSO.GetFolder(“C:\Scripts”)<br />Wscript.Echo “Date cr&#101;ated: “ &amp; objFolder.DateCr&#101;ated<br />Wscript.Echo “Date last accessed: “ &amp; <br />objFolder.DateLastAccessed<br />Wscript.Echo “Date last modified: “ &amp; <br />objFolder.DateLastModified<br />Wscript.Echo “Drive: “ &amp; objFolder.Drive<br />Wscript.Echo “Is root folder: “ &amp; objFolder.IsRootFolder<br />Wscript.Echo “Name: “ &amp; objFolder.Name<br />Wscript.Echo “Parent folder: “ &amp; objFolder.ParentFolder<br />Wscript.Echo “Path: “ &amp; objFolder.Path<br />Wscript.Echo “Short name: “ &amp; objFolder.ShortName<br />Wscript.Echo “Short path: “ &amp; objFolder.ShortPath<br />Wscript.Echo “Size: “ &amp; objFolder.Size<br />Wscript.Echo “Type: “ &amp; objFolder.Type<br /><br />检验文件夹是否存在<br />描述<br />演示脚本使用 FileSystemObject 检验文件夹是否存在。如果文件夹存在，此脚本就绑定到该文件夹。此脚本必须运行在本地计算机上。<br />脚本代码 <br />Set objFSO &#x3D; Cr&#101;ateObject(“Scripting.FileSystemObject”)<br />If objFSO.FolderExists(“C:\FSO”) Then<br />&nbsp;&nbsp;&nbsp;&nbsp;Set objFolder &#x3D; objFSO.GetFolder(“C:\FSO”)<br />Else<br />&nbsp;&nbsp;&nbsp;&nbsp;Wscript.Echo “Folder does not exist.”<br />End If<br /><br />检验文件是否存在<br />描述<br />演示脚本使用 FileSystemObject 检验文件是否存在。此脚本必须运行在本地计算机上。<br />脚本代码 <br />Set objFSO &#x3D; Cr&#101;ateObject(“Scripting.FileSystemObject”)<br />If objFSO.FileExists(“C:\FSO\ScriptLog.txt”) Then<br />&nbsp;&nbsp;&nbsp;&nbsp;Set objFolder &#x3D; <br />objFSO.GetFile(“C:\FSO\ScriptLog.txt”)<br />Else<br />&nbsp;&nbsp;&nbsp;&nbsp;Wscript.Echo “File does not exist.”<br />End If<br /><br />枚举一组特定的文件夹<br />描述<br />返回计算机上所有隐藏文件夹的列表。<br />脚本代码<br />strComputer &#x3D; “.”<br />Set objWMIService &#x3D; GetObject(“winmgmts:” _<br />&nbsp;&nbsp;&nbsp;&nbsp;&amp; “{impersonationLevel&#x3D;impersonate}!\“ &amp; strComputer <br />&amp; “\root\cimv2”)<br />Set colFiles &#x3D; objWMIService.ExecQuery _<br />&nbsp;&nbsp;&nbsp;&nbsp;(“Sel&#101;ct * from Win32_Directory Wh&#101;re Hidden &#x3D; True”)<br />For Each objFile in colFiles<br />&nbsp;&nbsp;&nbsp;&nbsp;Wscript.Echo objFile.Name<br />Next<br /><br />枚举文件夹中的所有文件<br />描述<br />返回 Scripts 文件夹中所有文件的列表。如果计算机有多个文件夹（例如 C:\Scripts 和 D:\Scripts），则文件将从这些文件夹中的每一个返回。<br />脚本代码<br />strComputer &#x3D; “.”<br />Set objWMIService &#x3D; GetObject(“winmgmts:” _<br />&nbsp;&nbsp;&nbsp;&nbsp;&amp; “{impersonationLevel&#x3D;impersonate}!\“ &amp; strComputer <br />&amp; “\root\cimv2”)<br />Set colFiles &#x3D; objWMIService. _<br />&nbsp;&nbsp;&nbsp;&nbsp;ExecQuery(“Sel&#101;ct * from CIM_DataFile wh&#101;re Path &#x3D; <br />‘\Scripts\‘“)<br />For Each objFile in colFiles<br />&nbsp;&nbsp;&nbsp;&nbsp;Wscript.Echo objFile.Name <br />Next<br /><br />枚举网络共享<br />描述<br />列出计算机上所有的共享文件夹。<br />脚本代码<br />strComputer &#x3D; “.”<br />Set objWMIService &#x3D; GetObject(“winmgmts:” _<br />&nbsp;&nbsp;&nbsp;&nbsp;&amp; “{impersonationLevel&#x3D;impersonate}!\“ &amp; strComputer <br />&amp; “\root\cimv2”)<br />Set colShares &#x3D; objWMIService.ExecQuery(“Sel&#101;ct * from <br />Win32_Share”)<br />For each objShare in colShares<br />&nbsp;&nbsp;&nbsp;&nbsp;Wscript.Echo “AllowMaximum: “ &amp; vbTab &amp; <br />objShare.AllowMaximum <br />&nbsp;&nbsp;&nbsp;&nbsp;Wscript.Echo “Caption: “ &amp; vbTab &amp; objShare.Caption <br />&nbsp;&nbsp;&nbsp;&nbsp;Wscript.Echo “MaximumAllowed: “ &amp; vbTab &amp; <br />objShare.MaximumAllowed<br />&nbsp;&nbsp;&nbsp;&nbsp;Wscript.Echo “Name: “ &amp; vbTab &amp; objShare.Name <br />&nbsp;&nbsp;&nbsp;&nbsp;Wscript.Echo “Path: “ &amp; vbTab &amp; objShare.Path <br />&nbsp;&nbsp;&nbsp;&nbsp;Wscript.Echo “Type: “ &amp; vbTab &amp; objShare.Type <br />Next<br /><br />检索扩展的文件属性<br />描述<br />使用 Shell 对象返回文件夹 C:\Scripts 中所有文件的扩展属性。<br />脚本代码 <br />Dim arrHeaders(34)<br />Set objShell &#x3D; Cr&#101;ateObject(“Shell.Application”)<br />Set objFolder &#x3D; objShell.Namespace(“C:\Scripts”)<br />For i &#x3D; 0 to 33<br />&nbsp;&nbsp;&nbsp;&nbsp;arrHeaders(i) &#x3D; <br />objFolder.GetDetailsOf(objFolder.Items, i)<br />Next<br />For Each strFileName in objFolder.Items<br />&nbsp;&nbsp;&nbsp;&nbsp;For i &#x3D; 0 to 33<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Wscript.echo i &amp; vbtab &amp; arrHeaders(i) _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp; “: “ &amp; objFolder.GetDetailsOf(strFileName, i) <br />&nbsp;&nbsp;&nbsp;&nbsp;Next<br />Next<br /><br />检索文件版本信息<br />描述<br />演示脚本使用 FileSystemObject 检索 .dll 文件的版本。此脚本必须运行在本地计算机上。<br />脚本代码 <br />Set objFSO &#x3D; Cr&#101;ateObject(“Scripting.FileSystemObject”)<br />Wscript.Echo <br />objFSO.GetFileVersion(“c:\windows\system32\scrrun.dll”)<br /><br />枚举已发布共享<br />描述<br />在 Active Directory 中枚举所有已经发布的共享文件夹。<br />脚本代码<br />Const ADS_SCOPE_SUBTREE &#x3D; 2<br />Set objConnection &#x3D; Cr&#101;ateObject(“ADODB.Connection”)<br />Set objCommand &#x3D; Cr&#101;ateObject(“ADODB.Command”)<br />objConnection.Provider &#x3D; “ADsDSOObject”<br />objConnection.Open “Active Directory Provider”<br />Set objCOmmand.ActiveConnection &#x3D; objConnection<br />objCommand.CommandText &#x3D; “Sel&#101;ct Name, unCName, ManagedBy <br />from “ _<br />&nbsp;&nbsp;&nbsp;&nbsp;&amp; “‘LDAP:&#x2F;&#x2F;DC&#x3D;Fabrikam,DC&#x3D;com’ wh&#101;re <br />objectClass&#x3D;’volume’”<br />objCommand.Properties(“Timeout”) &#x3D; 30 <br />objCommand.Properties(“Searchscope”) &#x3D; ADS_SCOPE_SUBTREE <br />objCommand.Properties(“Cache Results”) &#x3D; False <br />Set objRecordSet &#x3D; objCommand.Execute<br />objRecordSet.MoveFirst<br />Do Until objRecordSet.EOF<br />&nbsp;&nbsp;&nbsp;&nbsp;Wscript.Echo “Share Name: “ &amp; <br />objRecordSet.Fields(“Name”).Value<br />&nbsp;&nbsp;&nbsp;&nbsp;Wscript.Echo “UNC Name: “ &amp; <br />objRecordSet.Fields(“uNCName”).Value<br />&nbsp;&nbsp;&nbsp;&nbsp;Wscript.Echo “Managed By: “ &amp; <br />objRecordSet.Fields(“ManagedBy”).Value<br />&nbsp;&nbsp;&nbsp;&nbsp;objRecordSet.MoveNext<br />Loop</p>
</div><div class="tags"></div><div class="post-nav"><a class="pre" href="/2011/06/16/435-%E5%A5%B9%E6%8B%92%E7%BB%9D%E4%BA%86%E4%BB%96100%E6%AC%A1%EF%BC%8C%E4%BD%86%E7%AC%AC101%E6%AC%A1%E4%BB%96%E6%8B%92%E7%BB%9D%E4%BA%86%E5%A5%B9!/">她拒绝了他100次，但第101次他拒绝了她!</a><a class="next" href="/2011/06/12/433-%E8%83%83%E5%AF%92%E7%9A%84%E7%9A%84%E6%B2%BB%E7%96%97%E5%8F%8A%E6%97%A5%E5%B8%B8%E8%B0%83%E7%90%86/">胃寒的的治疗及日常调理</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="https://anthoney.github.io"/></form></div><div class="widget"><form class="search-form" action="//www.baidu.com/baidu" method="get" accept-charset="utf-8" target="_blank"><input type="search" name="word" maxlength="20" placeholder="Search"/><input type="hidden" name="si" value="https://anthoney.github.io"/><input name="tn" type="hidden" value="bds"/><input name="cl" type="hidden" value="3"/><input name="ct" type="hidden" value="2097152"/><input name="s" type="hidden" value="on"/></form></div><div class="widget"><div class="author-info"><a class="info-avatar" href="/about/" title="关于"><img class="nofancybox" src="/img/avatar.png"/></a><p>To be a better man.</p><a class="info-icon" href="https://twitter.com/yontaw" title="Twitter" target="_blank" style="margin-inline:5px"> <i class="fa fa-twitter-square" style="margin-inline:5px"></i></a><a class="info-icon" href="mailto:admin@from2.net" title="Email" target="_blank" style="margin-inline:5px"> <i class="fa fa-envelope-square" style="margin-inline:5px"></i></a><a class="info-icon" href="https://github.com/anthoney" title="Github" target="_blank" style="margin-inline:5px"> <i class="fa fa-github-square" style="margin-inline:5px"></i></a><a class="info-icon" href="/atom.xml" title="RSS" target="_blank" style="margin-inline:5px"> <i class="fa fa-rss-square" style="margin-inline:5px"></i></a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/GIS/">GIS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%BA%BA%E6%96%87%E5%9C%B0%E7%90%86/">人文地理</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%90%83%E5%96%9D%E7%8E%A9%E4%B9%90/">吃喝玩乐</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%A4%96%E8%AF%AD/">外语</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%BD%B1%E9%9F%B3%E5%9B%BE%E5%BD%A2/">影音图形</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%BF%83%E8%B7%AF/">心路</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9D%82%E8%B0%88/">杂谈</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%BD%AF%E4%BB%B6%E6%8A%80%E6%9C%AF/">软件技术</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%A3%9E%E8%A1%8C%E6%A2%A6%E6%83%B3/">飞行梦想</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2023/09/10/456-%E7%A9%BA%E9%97%B4%E5%88%B0%E6%9C%9F%E6%8D%A2/">用了17年的域名空间到期了，换了一个新的</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/09/30/455-FlexNet%20lmtools%20license%20vitual%20adapter%20Revit%E9%85%8D%E7%BD%AE%E8%99%9A%E6%8B%9F%E7%BD%91%E5%8D%A1/">FlexNet lmtools license vitual adapter Revit配置虚拟网卡</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/08/454-%E6%88%BF%E5%B1%8B%E5%9D%90%E5%90%91%E4%BB%A5%E4%BB%80%E4%B9%88%E4%B8%BA%E5%87%86%20%E6%88%BF%E5%B1%8B%E5%9D%90%E5%90%91%E6%80%8E%E4%B9%88%E7%9C%8B/">房屋坐向以什么为准 房屋坐向怎么看</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/01/12/453-FME%20Desktop%202021%20for%20Mac%E5%AE%89%E8%A3%85%E8%B8%A9%E5%9D%91%E6%95%99%E7%A8%8B/">FME Desktop 2021 for Mac安装踩坑教程</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04/29/452-%E4%BF%9D%E5%8F%B7google%20voice%E9%99%84%E4%BD%BF%E7%94%A8%E5%BB%BA%E8%AE%AE/">保号google voice附使用建议</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/14/451-5G%20Wifi%20Router%20Band%20Channel%20limit%E4%BF%AE%E6%94%B95GWIFI%E8%B7%AF%E7%94%B1%E4%B8%AD%E5%9B%BD%E9%A2%91%E6%AE%B5%E9%99%90%E5%88%B6/">5G Wifi Router Band Channel limit修改5GWIFI路由中国频段限制</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/22/450-%E8%80%81%E6%AC%BEiPhone%E5%8F%98%E6%85%A2%E5%8D%A1%E9%A1%BF%E6%8E%89%E5%B8%A7%E5%8F%91%E7%83%AD%E5%88%87%E6%8D%A2%E8%BF%9F%E7%BC%93%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95%E5%88%86%E4%BA%AB/">老款iPhone变慢卡顿掉帧发热切换迟缓解决方法分享</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/12/13/449-python%E4%B8%AD%E6%96%87%E5%AD%97%E7%AC%A6%E4%B9%B1%E7%A0%81%E8%A7%A3%E5%86%B3%E5%81%8F%E6%96%B9/">python中文字符乱码解决偏方</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/06/02/448-Python%20opencv%20error%20215%20imshow%20%E9%97%AE%E9%A2%98/">Python opencv error 215 imshow 问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/04/04/447-python%20faild_install_package%20%E6%8A%A5%E9%94%99%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/">python faild_install_package 报错解决办法</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2023 <a href="/." rel="nofollow">From to Earth.</a><a rel="nofollow" target="_blank" href="https://beian.miit.gov.cn">京ICP备16057264号</a>Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.js"></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.0"></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.css"><script type="text/javascript" src="/js/copycode.js?v=1.0.0" successtext="复制成功！"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css?v=1.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>