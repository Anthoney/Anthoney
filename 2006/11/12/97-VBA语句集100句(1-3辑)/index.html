<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><title>VBA语句集100句(1-3辑) | from2.net</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/latest/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/grids-responsive-min.min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/latest/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script type="text/javascript" src="//lib.baomitu.com/clipboard.js/latest/clipboard.min.js"></script><script type="text/javascript" src="//lib.baomitu.com/toastr.js/latest/toastr.min.js"></script><link rel="stylesheet" href="//lib.baomitu.com/toastr.js/latest/toastr.min.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">VBA语句集100句(1-3辑)</h1><a id="logo" href="/.">from2.net</a><p class="description"></p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">VBA语句集100句(1-3辑)</h1><div class="post-meta">2006-11-12<span> | </span><span class="category"><a href="/categories/%E8%BD%AF%E4%BB%B6%E6%8A%80%E6%9C%AF/">软件技术</a></span></div><div class="post-content"><p>[转贴]VBA语句集100句(1-3辑) <br /><a href="http://www.officefans.net/cdb/viewthread.php?tid=62739" rel="external" target="_blank">http://www.officefans.net/cdb/viewthread.php?tid=62739</a><br />‘定制模块行为<br />‘(1)强制对模块内所有变量进行声明<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Option Explicit<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’标记模块为私有，仅对同一工程中其它模块有用，在宏对话框中不显示<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Option Private Module<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’字符串不区分大小写<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Option Compare Text<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’指定数组的第一个下标为1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Option Base 1<br />‘(2)忽略错误继续执行VBA代码,避免出现错误消息<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;On Error Resume Next<br />‘(3)当错误发生时跳转到过程中的某个位置<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;On Error GoTo ErrorHandler<br />‘(4)恢复正常的错误提示<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;On Error GoTo 0<br />‘(5)在程序执行过程中使出现的警告框不显示<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.DisplayAlerts &#x3D; False<br />‘(6)关闭屏幕刷新<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.ScreenUpdating &#x3D; False<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’打开屏幕刷新<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.ScreenUpdating &#x3D; True<br />‘(7)禁用Ctrl+Break中止宏运行的功能<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.Enable.CancelKey &#x3D; xlDisabled<br />‘<br />‘工作簿<br />‘(8)创建一个新的工作簿<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Workbooks.Add()<br />‘(9)激活名为book1的工作簿<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Workbooks(“book1.xls”).Activate<br />‘(10)保存工作簿<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ThisWorkbook.Save<br />‘(11)关闭当前工作簿<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ThisWorkbook.Close<br />‘(12)获取活动工作薄中工作表数<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveWorkbook.Sheets.Count<br />‘(13)返回活动工作薄的名称<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveWorkbook.Name<br />‘(14)返回当前工作簿名称<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ThisWorkbook.Name<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’返回当前工作簿路径和名称<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ThisWorkbook.FullName<br />‘(15)禁止调整活动工作簿的大小<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveWindow.EnableResize &#x3D; False<br />‘(16)将工作簿以平铺方式排列<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.Window.Arrange xlArrangeStyleTiled<br />‘(17)将当前工作簿最大化<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveWorkbook.WindowState &#x3D; xlMaximized<br />‘<br />‘工作表<br />‘(18)当前工作表中已使用的行数<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.UsedRange.Rows.Count<br />‘(19)获取工作表的行数(注：考虑向前兼容性)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rows.Count<br />‘(20)将Sheet1命名为Sum<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sheets(Sheet1).Name &#x3D; “Sum”<br />‘(21)添加一个新工作表在第一工作表前<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ThisWorkbook.Sheets.Add Before:&#x3D;Worksheets(1)<br />‘(22)将当前工作表移至工作表的最后<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Move After:&#x3D;ActiveWorkbook. _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Sheets(ActiveWorkbook.Sheets.Count)<br />‘(23)同时选择工作表1和工作表2<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Worksheets(Array(“sheet1”, “sheet2”)).Sel&#101;ct<br />‘(24)删除工作表1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sheets(“sheet1”).Del&#101;te<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’或<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sheets(1).Del&#101;te<br />‘(25)获取工作表i的名称<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveWorkbook.Sheets(i).Name<br />‘(26)切换工作表中的网格线显示，这种方法也可以用在其它方面进行相互切换，即相当于开关按钮<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveWindow.DisplayGridlines &#x3D; Not ActiveWindow.DisplayGridlines<br />‘(27)切换工作表中的行列边框显示<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveWindow.DisplayHeadings &#x3D; Not ActiveWindow.DisplayHeadings<br />‘(28)删除当前工作表中所有的条件格式<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.UsedRange.FormatConditions.Del&#101;te<br />‘(29)取消当前工作表所有超链接<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cells.Hyperlinks.Del&#101;te<br />‘(30)将页面设置更改为横向<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.PageSetup.Orientation &#x3D; xlLandscape<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’或<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.PageSetup.Orientation &#x3D; 2<br />‘(31)在页面设置的表尾中输入文件路径<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.PageSetup.RightFooter &#x3D; ActiveWorkbook.FullName<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’将用户名放置在活动工作表的页脚<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.PageSetup.LeftFooter &#x3D; Application.UserName<br />‘<br />‘单元格&#x2F;单元格区域<br />‘(32)选择当前活动单元格所包含的范围，上下左右无空行<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveCell.CurrentRegion.Sel&#101;ct<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’或<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Range(ActiveCell.End(xlUp), ActiveCell.End(xlDown)).Sel&#101;ct<br />‘(33)选定当前工作表的所有单元格<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cells.Sel&#101;ct<br />‘(34)清除活动工作表上单元格A1中的内容<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Range(“A1”).ClearContents<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’清除选定区域内容<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sel&#101;ction.ClearContents<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’彻底清除A1至D4单元格区域的内容，包括格式<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Range(“A1:D4”).Clear<br />‘(35)清除工作表中所有单元格的内容<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cells.Clear<br />‘(36)活动单元格下移一行，同理，可下移一列<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveCell.Offset(1, 0).Sel&#101;ct<br />‘(37)偏移一列<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Range(“A1”).Offset(ColumnOffset:&#x3D;1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’或<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Range(“A1”).Offset(,1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’向上偏移一行<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Range(“A1”).Offset(Rowoffset:&#x3D;-1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’或<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Range(“A1”).Offset (-1)<br />‘(38)复制单元格A1，粘贴到单元格B1中<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Range(“A1”).Copy Range(“B1”)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’将单元格区域复制到单元格F1开始的区域中<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Range(“A1:D8”).Copy Range(“F1”)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’剪切单元格区域A1至D8，复制到单元格F1开始的区域中<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Range(“A1:D8”).Cut Range(“F1”)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’复制包含A1的单元格区域到工作表2中以A1起始的单元格区域中<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Range(“A1”).CurrentRegion.Copy Sheets(“Sheet2”).Range(“A1”)<br />‘注：CurrentRegion属性等价于定位命令，由一个矩形单元格块组成，周围是一个或多个空行或列<br />‘(39)将值XX输入到所选单元格区域中<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveWindow.RangeSel&#101;ction.Value &#x3D; XX<br />‘(40)活动窗口中选择的单元格数<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveWindow.RangeSel&#101;ction.Count<br />‘(41)当前选中区域的单元格数<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sel&#101;ction.Count<br />‘(42)返回单元格中超级链接的地址并赋值<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GetAddress &#x3D; Replace(Hyperlinkcell.Hyperlinks(1).Address, “mailto:”, “”)<br />‘(43)检查单元格A1的文本颜色并返回颜色索引<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TextColor &#x3D; Range(“A1”).Font.ColorIndex<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’获取单元格A1背景色<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Range(“A1”).Interior.ColorIndex<br />‘(44)返回当前工作表的单元格数<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cells.Count<br />‘(45)激活当前活动单元格下方3行，向右4列的单元格<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sel&#101;ction.Range(“E4”).Sel&#101;ct<br />‘(46)引单元格C5<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cells.Item(5,”C”)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’引单元格C5<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cells.Item(5,3)<br />‘(47)指定单元格F5<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Range(“A1”).Offset(RowOffset:&#x3D;4,ColumnOffset:&#x3D;5)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’或<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Range(“A1”).Offset(4, 5)<br />‘(48)创建B3：D13区域<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Range(“B3”).Resize(RowSize:&#x3D;11,ColumnSize:&#x3D;3)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rnage(“B3”).Resize(11,3)<br />‘(49)将Data区域扩充2列<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Range(“Data”).Resize(,2)<br />‘(50)将Data1和Data2区域连接<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Union(Range(“Data1”),Range(“Data2”))<br />‘(51)返回Data1和Data2区域的交叉区域<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Intersect(Range(“Data1”),Range(“Data2”))<br />‘(52)单元格区域Data中的单元格数<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Range(“Data”).Count<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’单元格区域Data中的列数<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Range(“Data”).Columns.Count<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’单元格区域Data中的行数<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Range(“Data”).Rows.Count<br />‘(53)当前选中的单元格区域中的列数<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sel&#101;ction.Columns.Count<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’当前选中的单元格区域中的行数<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sel&#101;ction.Rows.Count<br />‘(54)选中的单元格区域所包含的区域数<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sel&#101;ction.Areas.Count<br />‘(55)获取单元格区域中使用的第一行的行号<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.UsedRange.Row<br />‘(56)获取单元格区域Rng左上角单元格所在列编号<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rng.Column<br />‘(57)在活动工作表中返回所有符合条件格式设置的区域<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Cells.SpecialCells (xlCellTypeAllFormatConditions)<br />‘(58)关闭由于执行自动筛选命令产生的第3个字段的下拉列表<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Range(“A1”).AutoFilter Field:&#x3D;3, VisibleDro&#112;Down:&#x3D;False<br />‘<br />‘名称<br />‘(59)命名A1：C3区域为computer<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Range(“A1：C3”).Name &#x3D; “computer”<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’命名局部变量，即Sheet1上区域D1：E6为book<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’或<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Range(“D1：E6”).Name &#x3D; “Sheet1!book”<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’将区域computer重命名为robot<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’或<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Names(“computer”).Name &#x3D; “robot”<br />‘(60)删除名称<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Names(“book”).Del&#101;te<br />‘(61)动态命名列<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Names.Add Name:&#x3D;”ContentList”, _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RefersTo:&#x3D;”&#x3D;OFFSET(Sheet1!A2,0,0,COUNTA(Sheet2!＄A:＄A))”<br />‘(62)命名字符串CompanyCar<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Names.Add Name:&#x3D;”Company”, RefersTo:&#x3D;”CompanyCar”<br />‘(63)将数字123456命名为Total。注意数字不能加引号，否则就是命名字符串了。<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Names.Add Name:&#x3D;”Total”, RefersTo:&#x3D;123456<br />‘(64)将数组ArrayNum命名为MyArray。<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Names.Add Name:&#x3D;”MyArray”, RefersTo:&#x3D;ArrayNum<br />‘(65)将名称隐藏<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Names.Add Name:&#x3D;”ProduceNum”, RefersTo:&#x3D;”&#x3D;＄B＄1”, Visible:&#x3D;False<br />‘(66)返回名称字符串<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveWorkbook.Names(“Com”).Name<br />‘<br />‘公式与函数<br />‘(67)使用工作表函数检查A1单元格中的数据是否为数字<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.WorksheetFunction.IsNumber (“A1”)<br />‘(68)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Range(“A:A”).Find(Application.WorksheetFunction.Max(Range(“A:A”))).Activate<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’激活单元格区域A列中最大值的单元格<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />‘(69)在单元格中输入数组公式。注意必须使用R1C1样式的表达式<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cells(8, 8).FormulaArray &#x3D; “&#x3D;SUM(R2C[-1]:R[-1]C[-1]<em>R2C:R[-1]C)”<br />‘<br />‘图表<br />‘(70)获取当前工作表中图表的个数<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.ChartObjects.Count<br />‘(71)选中当前工作表中图表Chart1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.ChartObjects(“Chart1”).Sel&#101;ct<br />‘(72)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.ChartObjects(“Chart1”).Activate<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’选中当前图表区域<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveChart.ChartArea.Sel&#101;ct<br />‘(73)更改工作表中图表的图表区的颜色<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Worksheets(“Sheet1”).ChartObjects(“Chart2”).Chart. _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ChartArea.Interior.ColorIndex &#x3D; 2<br />‘(74)更改图表工作表中图表区的颜色<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sheets(“Chart2”).ChartArea.Interior.ColorIndex &#x3D; 2<br />‘(75)添加新的图表工作表<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Charts.Add<br />‘(76)指定图表数据源并按列排列<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveChart.SetSourceData Source:&#x3D;Sheets(“Sheet1”).Range(“A1:D5”), _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PlotBy:&#x3D;xlColumns<br />‘(77)新图表作为新图表工作表<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveChart.Location Wh&#101;re:&#x3D;xlLocationAsNewSheet<br />‘(78)将绘图区颜色变为白色<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveChart.PlotArea.Interior.ColorIndex &#x3D; xlNone<br />‘(79)将图表1导出到C盘上并命名为MyChart.gif<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Worksheets(“Sheet1”).ChartObjects(1).Chart. _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Export Filename:&#x3D;”C：MyChart.gif”, FilterName:&#x3D;”GIF”<br />‘<br />‘窗体<br />‘(80)消息框中显示消息Hello<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MsgBox “Hello!”<br />‘(81)在消息框中点击”是”按钮，则Ans值为vbYes；点击”否”按钮，则Ans值为vbNo。<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ans &#x3D; MsgBox(“Continue?”, vbYesNo)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’返回值不为”是”，则退出<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If MsgBox(“Continue?”, vbYesNo) &lt;&gt; vbYes Then Exit Sub<br />‘(82)使用常量的组合，赋值组Config变量，并设置第二个按钮为缺省按钮<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Config &#x3D; vbYesNo + vbQuestion + vbDefaultButton2<br />‘(83)在消息框中强制换行，可用vbCrLf代替vbNewLine。<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MsgBox “This is the first line.” &amp; vbNewLine &amp; “Second line.”<br />‘(84)应用工作表函数返回所选区域的平均值并按指定格式显示<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MsgBox “the average is :” &amp; _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Format(Application.WorksheetFunction.Average(Sel&#101;ction), “#,##0.00”), vbInformation, “sel&#101;ction count average” &amp; Chr(13)<br />‘(85)显示用户窗体<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UserForm1.Show<br />‘(86)加载一个用户窗体,但该窗体处于隐藏状态<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Load UserForm1<br />‘(87)隐藏用户窗体<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UserForm1.Hide<br />‘(88)卸载用户窗体<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Unload UserForm1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’或<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Unload Me<br />‘(89)在用户窗体中显示图形<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Picture1.Picture &#x3D; LoadPicture(“C:1.JPG”)<br />‘(90)将窗体设置为无模式状态<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UserForm1.Show 0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’或<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UserForm1.Show vbModeless<br />‘(91)窗体高度为当前活动窗口高度的0.88<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Me.Height &#x3D; Int(0.88 * ActiveWindow.Height)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’窗体宽度为当前活动窗口高度的0.88<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Me.Width &#x3D; Int(0.88 * ActiveWindow.Width)<br />‘<br />‘事件<br />‘(92)禁用所有事件<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.EnableEvents &#x3D; False<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’启用所有事件<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.EnableEvents &#x3D; True<br />‘注：不适用于用户窗体控件触发的事件<br />‘对象<br />‘(93)创建一个Excel工作表对象<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set ExcelSheet &#x3D; Cr&#101;ateObject(“Excel.Sheet”)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’设置 Application 对象使 Excel 可见<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ExcelSheet.Application.Visible &#x3D; True<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’在表格的第一个单元中输入文本<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ExcelSheet.Application.Cells(1, 1).Value &#x3D; “Data”<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’将该表格保存到C:test.xls 目录<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ExcelSheet.SaveAs “C:TEST.XLS”<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’关闭 Excel<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ExcelSheet.Application.Quit<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’释放该对象变量<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set ExcelSheet &#x3D; Nothing<br />‘(94)声明并创建一个Excel对象引用<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim xlApp As Excel.Application<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim xlBook As Excel.Workbook<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim xlSheet As Excel.Worksheet<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set xlApp &#x3D; Cr&#101;ateObject(“Excel.Application”)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set xlBook &#x3D; xlApp.Workbooks.Add<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set xlSheet &#x3D; xlBook.Worksheets(1)<br />‘(95)创建并传递一个 Excel.Application 对象的引用<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call MySub(Cr&#101;ateObject(“Excel.Application”))<br />‘(96)创建一个 Dictionary 对象变量<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set d &#x3D; Cr&#101;ateObject(Scripting.Dictionary)<br />‘(97)为对象变量添加关键字和条目<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d.Add “a”, “Athens”<br />‘<br />‘其他<br />‘(98)设置Ctrl+I键为macro过程的快捷键<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.OnKey “^I”, “macro”<br />‘(99)退出剪切&#x2F;复制模式<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.CutCopyMode &#x3D; False<br />‘(100)无论何时工作表中任意单元格重新计算，都会强制计算该函数<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.Volatile True<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’只有在该函数的一个或多个参数发生改变时，才会重新计算该函数<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.Volatile False<br />‘</em><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><br />‘&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;定制模块行为<br />‘(101)清除程序运行过程中所有的错误<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Err.Clear<br />‘</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong><em><br />‘&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;工作簿<br />‘(102)返回上次保存工作簿的日期和时间<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ThisWorkbook.BuiltinDocumentProperties (“Last Save Time”)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‘或<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Application.Caller.Parent.Parent.BuiltinDocumentProperties (“Last Save Time”)<br />‘(103)返回上次打印或预览工作簿的日期和时间<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ThisWorkbook.BuiltinDocumentProperties (“Last Print Date”)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‘或<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Application.Caller.Parent.Parent.BuiltinDocumentProperties (“Last Print Date”)<br />‘(104)关闭所有打开的工作簿<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Workbooks.Close<br />‘(105)返回当前工作簿中的第一条链接<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveWorkbook.LinkSources(xlExcelLinks)(1)<br />‘(106)返回工作簿代码的名称<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ActiveWorkbook.CodeName<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ThisWorkbook.CodeName<br />‘(107)返回当前工作簿文件格式代码<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ActiveWorkbook.FileFormat<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ThisWorkbook.FileFormat<br />‘(108)返回当前工作簿的路径(注:若工作簿未保存,则为空)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ThisWorkbook.Path<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ActiveWorkbook.Path<br />‘(109)返回当前工作簿的读&#x2F;写值(为False)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ThisWorkbook.ReadOnly<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ActiveWorkbook.ReadOnly<br />‘(110)返回工作簿的存储值(若已保存则为False)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ThisWorkbook.Saved<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveWorkbook.Saved<br />‘(111)隐藏工作簿<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.Visible &#x3D; False<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’显示工作簿<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.Visible &#x3D; True<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’注:可与用户窗体配合使用,即在打开工作簿时将工作簿隐藏,只显示用户窗体.可设置控制按钮控制工作簿可见<br />‘</em><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><br />‘&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;工作表<br />‘(112)在A列右侧插入列，即插入B列<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Columns(“B”).Ins&#101;rt<br />‘&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Columns(“E”).Cut<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’以上两句将E列数据移至B列，原B列及以后的数据相应后移<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Columns(“B”).Ins&#101;rt<br />‘&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Columns(“B”).Cut<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’以上两句将B列数据移至D列，原C列和D列数据相应左移一列<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Columns(“E”).Ins&#101;rt<br />‘(113)计算当前工作表<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Calculate<br />‘(114)正常隐藏工作表，同在Excel菜单中选择”格式——工作表——隐藏”操作一样<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ThisWorkbook.Worksheets(“sheet1”).Visible &#x3D; xlSheetHidden<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’隐藏工作表，不能通过在Excel菜单中选择”格式——工作表——取消隐藏”来重新显示工作表<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ThisWorkbook.Worksheets(“sheet1”).Visible &#x3D; xlSheetVeryHidden<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’显示被隐藏的工作表<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ThisWorkbook.Worksheets(“sheet1”).Visible &#x3D; xlSheetVisible<br />‘(115)检查工作表是否受到保护<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ThisWorkbook.Sheets(1).ProtectContents<br />‘(116)在第二个工作表之前添加两个新的工作表<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ThisWorkbook.Worksheets.Add Count:&#x3D;2, _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Before:&#x3D;ThisWorkbook.Worksheets(2)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’或<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ThisWorkbook.Workshees.Add ThisWorkbook.Worksheets(2), , 2<br />‘(117)复制一个工作表到新的工作簿<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ThisWorkbook.Worksheets(3).Copy<br />‘(118)复制第三个工作表到第二个工作表之前<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ThisWorkbook.Worksheets(3).Copy ThisWorkbook.Worksheets(2)<br />‘(119)改变工作表的列宽为20<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ThisWorkbook.ActiveSheet.Columns.ColumnWidth &#x3D; 20<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’将工作表的列宽恢复为标准值<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ThisWorkbook.ActiveSheet.Columns.ColumnWidth &#x3D; _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ThisWorkbook.ActiveSheet.StandardWidth<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’改变工作表列1的宽度为20<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ThisWorkbook.ActiveSheet.Columns(1).ColumnWidth &#x3D; 20<br />‘(120)改变工作表的行高为10<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ThisWorkbook.ActiveSheet.Rows.RowHeight &#x3D; 10<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’将工作表的行高恢复为标准值<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ThisWorkbook.ActiveSheet.Rows.RowHeight &#x3D; _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ThisWorkbook.ActiveSheet.StandardHeight<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’改变工作表的行1的高度值设置为10<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ThisWorkbook.ActiveSheet.Rows(1).RowHeight &#x3D; 10<br />‘(121)当前工作簿中的第一个工作表被激活<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ThisWorkbook.Worksheets(1).Activate<br />‘(122)设置工作表Sheet1中的行1数据为粗体<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ThisWorkbook.Worksheets(“Sheet1”).Rows(1).Font.Bold &#x3D; True<br />‘(123)将工作表Sheet1中的行1隐藏<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ThisWorkbook.Worksheets(“Sheet1”).Rows(1).Hidden &#x3D; True<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’将当前工作表中活动单元格所在的行隐藏<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveCell.EntireRow.Hidden &#x3D; True<br />‘&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;注：同样可用于列。<br />‘(124)自动调整当前工作表A列列宽<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Range(“A:A”).EntireColumn.AutoFit<br />‘(125)选中当前工作表中常量和文本单元格<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Cells.SpecialCells(xlCellTypeConstants,xlTextValues)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’选中当前工作表中常量和文本及错误值单元格<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Cells.SpecialCells(xlCellTypeConstants,xlErrors+xlTextValues)<br />‘</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong><em><br />‘&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;公式与函数<br />‘(126)将自定义的SumPro函数指定给Excel中的”统计函数”类别<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.MacroOptions Macro:&#x3D;”SumPro”, Category:&#x3D;4<br />‘(127)为自定义函数SumPro进行了功能说明<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Application.MacroOptions Macro:&#x3D;”SumPro”, _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Description:&#x3D;”First Sum,then Product”<br />‘(128)获取A列的下一个空单元格<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.WorksheetFunction.CountA (Range(“A:A”)) + 1<br />‘(129)返回该单元格所在列非空单元格的数量<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WorksheetFunction.CountA (Cell.EntireColumn)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’返回该单元格所在行非空单元格的数量<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WorksheetFunction.CountA (Cell.EntireRow)<br />‘(130)返回工作表中非空单元格数量<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WorksheetFunction.CountA (Cells)<br />‘(131)对A列至D列前19个数值求和<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ActiveSheet.Range(“A20:D20”).Formula &#x3D; “&#x3D;Sum(R[-19]C:R[-1]C”<br />‘</em><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><br />‘&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;图表<br />‘(132)使图表处于非活动状态<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ActiveWindow.Visible &#x3D; False<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’或<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ActiveChart.Desel&#101;ct<br />‘(133)若选中的为图表，则该语句为真，否则为假<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TypeName(Sel&#101;ction) &#x3D; “Chart”<br />‘(134)删除工作表上所有的ChartObject对象<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.ChartObjects.Del&#101;te<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’删除当前工作簿中所有的图表工作表<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveWorkbook.Charts.Del&#101;te<br />‘</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong><em><br />‘&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;窗体和控件<br />‘(135)添加用户窗体MyForm并显示<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UserForms.Add(MyForm).Show<br />‘(136)设置文本框获取输入焦点<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TextName.SetFocus<br />‘(137)将数值调节钮控件的值改为0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SpinButton1.Value &#x3D; 0<br />‘(138)将数值调节钮控件的值赋值给文本框控件<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TextBox1.Text &#x3D; SpinButton1.Value<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’将文本框控件值赋给数值调节钮控件<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SpinButton1.Value &#x3D; “&#x2F;Val(TextBox1.Text)”<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’数值调节钮控件和文本框控件相比较<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CStr(SpinButton1.Value)&#x3D;TextBox1.Text<br />‘(139)显示窗体UserForm1上的控件数目<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UserForm1.Controls.Count<br />‘(140)在列表框中添加Command1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ListBox1.AddItem “Command1”<br />‘(141)返回列表框中条目的值，若为-1，则表明未选中任何列表框中的条目<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ListBox1.ListIndex<br />‘(142)返回代表单元格区域地址的文本字符串<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RefEdit1.Text<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’初始化RefEdit控件显示当前所选单元格区域<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RefEdit1.Text &#x3D; ActiveWindow.RangeSel&#101;ction.Address<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’设置某单元格区域左上角单元格<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set FirstCell &#x3D; Range(RefEdit1.Text).Range(“A1”)<br />‘(143)等待15秒后运行myProcedure过程<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.OnTime Now + TimeValue(“00:00:15”), “myProcedure”<br />‘(144)将滚动条控件的值赋值给ActiveWindow对象的ScrollColumn属性<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveWindow.ScrollColumn &#x3D; ScrollBarColumns.Value<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’将滚动条控件的值赋值给ActiveWindow对象的ScrollRow属性<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveWindow.ScrollRow &#x3D; ScrollBarRows.Value<br />‘(145)将单元格A1中的数据添加到列表框中<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UserForm1.ListBox1.AddItem Sheets(“Sheet1”).Cells(1, 1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’将一个名为Product数组的值添加到ListBox1中<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ListBox1.List &#x3D; Product<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’使用工作表Sheet2中的SumP区域的值填充列表框<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ListBox1.RowSource &#x3D; “Sheet2!SumP”<br />‘(146)选中列表框中的第一个条目(注：当列表框允许一次选中多个条目时，必须使用Sel&#101;cted属性)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ListBox1.Sel&#101;cted (0)<br />‘(147)移除列表框中选中的条目<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ListBox1.RemoveItem ListBox1.ListIndex<br />‘</em><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><br />‘&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;对象<br />‘&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application对象<br />‘(148)返回应用程序的用户名<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.UserName<br />‘(149)返回代表调用函数的单元格<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.Caller<br />‘(150)返回调用函数的工作簿名称<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.Caller.Parent.Parent<br />‘(151)将文本写到状态栏<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.StatusBar &#x3D; “请等待……”<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’更新状态栏文本，以变量Percent代表完成的百分比<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.StatusBar &#x3D; “请等待……” &amp; Percent &amp; “% Completed”<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’将状态栏重新设置成正常状态<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.StatusBar &#x3D; False<br />‘(152)指定单元格区域A1至D4，等同于选择”编辑——定位”，指定单元格区域为A1至D4，不会出现”定位”对话框<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.Goto Reference:&#x3D;Range(“A1:D4”)<br />‘(153)显示”定位”对话框，但定位条件按钮无效<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.Dialogs(xlDialogFormulaGoto).Show<br />‘(154)显示”定位条件”对话框<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.Dialogs(xlDialogSel&#101;ctSpecial).Show<br />‘(155)显示”单元格格式”中的”数字”选项卡<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.Dialogs(xlDialogFormatNumber).Show<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’显示”单元格格式”中的”对齐”选项卡<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.Dialogs(xlDialogAlignment).Show<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’显示”单元格格式”中的”字体”选项卡<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.Dialogs(xlDialogFontProperties).Show<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’显示”单元格格式”中的”边框”选项卡<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.Dialogs(xlDialogBorder).Show<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’显示”单元格格式”中的”图案”选项卡<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.Dialogs(xlDialogPatterns).Show<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’显示”单元格格式”中的”保护”选项卡<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.Dialogs(xlDialogCellProtection).Show<br />‘&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;注：无法一次显示带选项卡的”单元格格式”对话框，只能一次显示一个选项卡。<br />‘(156)显示”引用位置”的默认单元格区域并显示引用使其出现在窗口左上角(注：内置对话框参数的使用)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.Dialogs(xlDialogFormulaGoto).Show Range(“b2”), True<br />‘(157)执行”定位”话框，相当于选择菜单”编辑——定位”命令<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.CommandBars(1).Controls(2).Controls(16).Execute<br />‘(158)返回一个垂直的数组<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.Transpose (Array(“Sun”, “Mon”, “Tur”, “Wed”, “Thu”, “Fri”, “Sat”))<br />‘(159)返回使用的Excel版本号<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.Version<br />‘(160)设置光标形状为北西向箭头<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.Cursor &#x3D; xlNorthwestArrow<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’设置光标形状为Ⅰ字形<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.Cursor &#x3D; xlIBeam<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’设置光标形状为沙漏(等待)形<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.Cursor &#x3D; xlWait<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’恢复光标的默认设置<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.Cursor &#x3D; xlDefault<br />‘(161)返回窗口当前的状态<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.WindowState<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’窗口最小化<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.WindowState &#x3D; xlMinimized<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’窗口最大化<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.WindowState &#x3D; xlMaximized<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’窗口正常状态<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.WindowState &#x3D; xlNormal<br />‘(162)获取当前窗口的高度<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.UsableHeight<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’获取当前窗口的宽度<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.UsableWidth<br />‘(163)返回活动单元格的地址(注:返回的是绝对地址)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.ActiveCell.Address<br />‘(164)返回当前打印机的名称<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.ActivePrinter<br />‘(165)返回活动工作表的名称<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.ActiveSheet.Name<br />‘(166)返回活动窗口的标题<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.ActiveWindow.Caption<br />‘(167)返回活动工作簿的名称<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.ActiveWorkbook.Name<br />‘(168)返回所选区域的地址<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.Sel&#101;ction.Address<br />‘(169)返回当前工作簿的名称<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.ThisWorkbook.Name<br />‘(170)返回Excel计算引擎版本(右边四位数字)及Excel版本(左边两位数字)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.CalculationVersion<br />‘(171)以字节为单位返回Excel允许使用的内存数(不包括已经使用的内存)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.MemoryFree<br />‘(172)以字节为单位返回Excel当前使用的内存数<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.MemoryUsed<br />‘(173)以字节为单位返回Excel可以使用的内存数(包括已使用的内存,是MemoryFree和MemoryUsed的总和)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.MemoryTotal<br />‘(174)返回所使用的操作系统的名称和版本<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.OperatingSystem<br />‘(175)返回Excel产品登记使用的组织机构的名称<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.OrganizationName<br />‘(176)查找的格式种类<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.FindFormat<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’替换查找到的内容的格式种类<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.ReplaceFormat<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’替换查找到的格式<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ActiveSheet.Cells.Replace What:&#x3D;” “, _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Replacement:&#x3D;” “, SearchFormat:&#x3D;True, ReplaceFormat:&#x3D;True<br />‘(177)忽略键盘或鼠标的输入<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.Interactive &#x3D; False<br />‘(178)若在工作表中定义了常量0.06的名称为”Rate”,则本语句将返回值0.06<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.Evaluate (“Rate”)<br />‘(179)选择UndoOption后，将执行Undo Procedure过程<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.OnUndo “Undo Option”, “Undo Procedure”<br />‘</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong><em><br />‘&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Range对象<br />‘(180)将一个含有10个元素的数组转置成垂直方向的工作表单元格区域(A1至A10)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Range(A1:A10).value&#x3D;”&#x2F;Application.WorksheetFunction.Transpose(MyArray)”<br />‘&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;注：因为当把一维数组的内容传递给某个单元格区域时，该单元格区域中的单元格必须是水平方向的，即含有多列的一行。若必须使用垂直方向的单元格区域，则必须先将数组进行转置，成为垂直的。<br />‘(181)返回A列最后一行的下一行<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Range(“A65536”).End(xlUp).Row 1<br />‘(182)返回区域左上角的单元格<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rng.Range (“A1”)<br />‘(183)访问当前单元格所在的工作簿<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cell.Parent.Parent.Worksheets<br />‘(184)切换所选单元格是否加粗<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sel&#101;ction.Font.Bold &#x3D; Not Sel&#101;ction.Font.Bold<br />‘(185)两个关键字排序，相邻两列，B列为主关键字，A列为次关键字，升序排列<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ActiveSheet.Range(“A:B”).Sort Key1:&#x3D;Columns(“B”), Key2:&#x3D;Columns(“A”), _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Header:&#x3D;xlYes<br />‘(186)显示单元格或单元格区域中的第一个单元格的数字格式<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cell.Range(“A1”).NumberFormat<br />‘(187)检查单元格或单元格区域中的第一个单元格是否含有公式<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cell.Range(“A1”).HasFormula<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’工作表中单元格是否含有公式<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;或cell.HasFormula<br />‘(188)单元格所在的整列<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cell.EntireColumn<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’单元格所在的整行<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Cell.EntireRow<br />‘(189)显示rng区域的名称<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rng.Name.Name<br />‘(190)返回rng区域的地址<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rng.Address<br />‘(191)返回包含在rng区域中左上角单元格中的公式。<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cell.Range(“A1”).Formula<br />‘&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;注：若在一个由多个单元格组成的范围内使用Formula属性，会得到错误；若单元格中没有公式，会得到一个字符串，在公式栏中显示该单元格的值。<br />‘(192)返回单元格区域D5:D10中左上角单元格<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Range(“D5:D10”).Cells(1,1)<br />‘(193)活动单元格所在的行数<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveCell.Row<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’活动单元格所在的列数<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ActiveCell.Column<br />‘(194)当前工作表中的单元格区域数据设置为左对齐<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Range(“A1:B1”).HorizontalAlignment &#x3D; xlLeft<br />‘(195)设置单元格区域A2至A10中数值格式<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Range(“A2:A10”).NumberFormat &#x3D; “#,##0”<br />‘(196)用0替换单元格区域中的空单元格<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rng.Replace “ “, “0”<br />‘</em><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><br />‘&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Collection与object<br />‘(197)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim colMySheets As New Collection<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’声明新的集合变量<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Public colMySheets As New Collection<br />‘(198)创建一个名为MyRange的对象变量<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set MyRange &#x3D; Range(“A1:A5”)<br />‘(199)向集合中添加惟一的条目(即将重复的条目忽略)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;objColl.Add Cell.Value, CStr(Cell.Value)<br />‘</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong>*<br />‘&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Windows API<br />‘(200)API函数声明。<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‘返回安装Windows所在的目录名称，调用该函数后，安装Windows的目录名称将在第一个参数lpBuffer中，该目录名称的字符串长度包含在第二个参数nSize中<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Declare Function GetWindowsDirectoryA Lib “kernel32” (ByVal lpBuffer As String, ByVal nSize As Long) As Long<br />‘(201)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set objExcel &#x3D; Cr&#101;ateObject(“Excel.Application”)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’创建Excel工作簿<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;objExcel.Workbooks.Add<br />‘(202)开启Word应用程序<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.ActivateMicrosoftApp xlMicrosoftWord<br />‘(203)获取工作簿模板的位置<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.TemplatesPath<br />‘(204)设置工作簿手动计算<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.Calculation &#x3D; xlCalculationManual<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’工作簿自动计算<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Application.Calculation &#x3D; xlCalculationAutomatic<br />‘(205)不对第一张工作表自动进行重算<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Worksheets(1).EnableCalculation &#x3D; False<br />‘(206)重新计算所有打开的工作簿中的数据<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.CalculateFull<br />‘(207)将最近使用的文档列表数设为5<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.RecentFiles.Maximum &#x3D; 5<br />‘(208)打开最近打开的文档中的第4个文档<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.RecentFiles(4).Open<br />‘(209)在2006年6月6日的16:16:16开始运行BaoPo过程<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.OnTime DateSerial(2006, 6, 6) + TimeValue(“16:16:16”), “BaoPo”<br />‘(210)播放声音，并使用用户的姓名问候用户<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.Speech.Speak (“Hello” &amp; Application.UserName)<br />‘(211)获取””号<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MsgBox Application.PathSeparator<br />‘(212)返回应用程序当前所在国家的设置信息<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MsgBox Application.International(xlCountrySetting)<br />‘(213)自动将在工作表中进行输入的”葛洲坝”更正为”三峡”<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.AutoCorrect.AddReplacement “葛洲坝”, “三峡”<br />‘(214)让计算机发出声音<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Beep<br />‘(215)返回错误代码<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Err.Number<br />‘(216)获取输入法状态<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MsgBox IMEStatus<br />‘(217)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Date &#x3D; #6&#x2F;6&#x2F;2006#<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’将系统时间更改为2006年6月6日上午6时16分16秒<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time &#x3D; #6:16:16 AM#<br />‘(218)切换是否能利用鼠标中间的滑轮放大&#x2F;缩小工作表<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.RollZoom &#x3D; Not Application.RollZoom<br />‘(219)显示任务栏中的窗口,即各工作簿占用各自的窗口<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.ShowWindowsInTaskba &#x3D; True<br />‘(220)显示窗口上的滚动条<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.DisplayScrollBars &#x3D; True<br />‘(221)切换是否显示编辑栏<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.DisplayFormulaBar &#x3D; Not Application.DisplayFormulaBar<br />‘(222)显示打印内容对话框<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.Dialogs(xlDialogPrint).Show<br />‘(223)设置按Enter键后单元格的移动方向向右<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.MoveAfterReturnDirection &#x3D; xlToRight<br />‘(224)显示打开对话框<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.FindFile<br />‘(225)打开超链接文档<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ThisWorkbook.FollowHyperlink “<a href="http://fanjy.blog.excelhome.net" rel="external" target="_blank">http://fanjy.blog.excelhome.net</a>“<br />‘(226)将当前工作簿设置为只读<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveWorkbook.ChangeFileAccess Mode:&#x3D;xlReadOnly<br />‘(227)将当前工作簿添加到收藏夹文件夹中<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveWorkbook.AddToFavorites<br />‘(228)在当前工作表中执行”拼写检查”<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.CheckSpelling<br />‘(229)保护当前工作表<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Protect userinterfaceonly:&#x3D;True<br />‘(230)在当前工作表的左侧页眉处打印出工作簿的完整路径和文件名<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.PageSetup.LeftHeader &#x3D; ThisWorkbook.FullName<br />‘(231)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’解除对工作表Sheet1中A1:G37区域单元格的锁定,以便当该工作表受保护时也可对这些单元格进行修改<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Worksheets(“Sheet1”).Range(“A1:G37”).Locked &#x3D; False<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Worksheets(“Sheet1”).Protect<br />‘(232)显示工作表sheet1的打印预览窗口<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Worksheets(“Sheet1”).PrintPreview<br />‘(233)禁用显示在Excel的”打印预览”窗口中的”设置”和”页边距”按钮<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.PrintPreview Enablechanges:&#x3D;False<br />‘(234)在打印预览中显示网格线<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.PageSetup.PrintGridlines &#x3D; True<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’在打印预览中显示行列编号<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.PageSetup.PrintHeadings &#x3D; True<br />‘(235)开启数据记录单<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.ShowDataForm<br />‘(236)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‘将工作表sheet1中A列的SIN替换为COS<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Worksheets(“Sheet1”).Columns(“A”).Replace _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;What:&#x3D;”SIN”, Replacement:&#x3D;”COS”, _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SearchOrder:&#x3D;xlByColumns, MatchCase:&#x3D;True<br />‘(237)删除当前工作表中的第2行<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rows(2).Del&#101;te<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’删除当前工作表中的第2列<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Columns(2).Del&#101;te<br />‘(238)在当前单元格左侧插入一条垂直分页符<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveWindow.Sel&#101;ctedSheets.VPageBreaks.Add before:&#x3D;ActiveCell<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’在当前单元格上方插入一条垂直分页符<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveWindow.Sel&#101;ctedSheets.HPageBreaks.Add before:&#x3D;ActiveCell<br />‘(239)将当前工作表窗口滚动到第14行<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveWindow.ScrollRow &#x3D; 14<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’将当前工作表窗口滚动到第13列<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveWindow.ScrollColumn &#x3D; 13<br />‘(240)关闭当前窗口<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveWindow.Close<br />‘(241)获取当前窗口中的窗格数<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveWindow.Panes.Count<br />‘(242)将A2至D2的单元格名称设定为A1到D1单元格的内容<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Worksheets(“sheet1”).Range(“A1:D2”).Cr&#101;ateNames Top:&#x3D;True<br />‘(243)自定义当前工作表中单元格A1至A8中的内容为自动填充序列<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application.AddCustomList listarray:&#x3D;Range(“A1:A8”)<br />‘(244)将单元格A1至B2的内容复制成屏幕快照<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Worksheets(“sheet1”).Range(“A1:B2”).CopyPicture xlScreen, xlBitmap<br />‘(245)删除所选区域的所有链接<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sel&#101;ction.Hyperlinks.Del&#101;te<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’删除第1列中所有的链接<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Columns(1).Hyperlinks.Del&#101;te<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’删除第1行中所有的链接<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rows(1).Hyperlinks.Del&#101;te<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’删除指定范围所有的链接<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Range(“A1:Z30”).Hyperlinks.Del&#101;te<br />‘(246)’在活动单元格中设置开启Windows计算器链接器<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ActiveCell.Hyperlinks.Add Anchor:&#x3D;ActiveCell, _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Address:&#x3D;”C:WindowsSystem32Calc.exe”, ScreenTip:&#x3D;”按下我，就会开启Windows计算器”, TextToDisplay:&#x3D;”Windows计算”<br />‘(247)开启Windows计算器<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveCell.Value &#x3D; Shell(“C:WindowsSystem32Calc.exe”, vbNormalFocus)<br />‘(248)打开自动筛选。若再运行一次，则关闭自动筛选<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Rows(1).AutoFilter<br />‘(249)开启&#x2F;关闭所选区域的自动筛选<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sel&#101;ction.AutoFilter<br />‘(250)关闭自动筛选<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.ShowAllData<br />‘(251)检查自动筛选是否开启，若开启则该语句返回True<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.AutoFilterMode<br />‘(252)’在A列中找出与单元格A2内容不同的单元格并删除<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ActiveSheet.Columns(“A”).ColumnDifferences(Comparison:&#x3D;ActiveSheet. _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Range(“A2”)).Del&#101;te<br />‘(253)删除单元格A6中的批注，包括声音批注和文字批注<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Range(“A6”).ClearNotes<br />‘(254)删除单元格B8中的批注文字<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Range(“B8”).ClearComments<br />‘(255)清除单元格区域A1至D10中的格式<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Range(“A1:D10”).ClearFormats<br />‘(256)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‘将单元格B2至D2区域设置为蓝色双线<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ActiveSheet.Range(“B2:D2”).BorderAround ColorIndex:&#x3D;5, _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Weight:&#x3D;xlMedium, LineStyle:&#x3D;xlDouble<br />‘(257)引用单元格C2的数据<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Range(“A1:B2”).Item(2, 3)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Range(“A1:B2”)(2, 3)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’引用单元格A2<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Range(“A1:B2”)(3)<br />‘(258)设置字体加粗<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Cells(1, 1).Font.Bold &#x3D; True<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’设置字体大小为24磅<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Cells(1, 1).Font.Size &#x3D; 24<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’设置字体颜色为红色<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Cells(1, 1).Font.ColorIndex &#x3D; 3<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’设置字体为斜体<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Cells(1, 1).Font.Italic &#x3D; True<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’设置字体类型<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Cells(1, 1).Font.Name &#x3D; “Times New Roman”<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’将单元格的背景色设置为红色<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Cells(1, 1).Interior.ColorIndex &#x3D; 3<br />‘(259)将当前工作表中单元格区域C2至E6格式自动调整为彩色3格式<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Range(“C2:E6”).AutoFormat Format:&#x3D;xlRangeAutoFormatColor3<br />‘(260)选中当前工作表中的最后一个单元格<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cells.SpecialCells (xlCellTypeLastCell)<br />‘(261)选定包含活动单元格的整个数组单元格区域.假定该单元格在数据单元格区域中<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveCell.CurrentArray.Sel&#101;ct<br />‘(262)将当前单元格数字格式设置为带3位小数,若为负数则显示为红色<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveCell.NumberFormatLocal &#x3D; “0.000; [红色] 0.000”<br />‘(263)判断活动单元格中是否有值<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IsEmpty (ActiveCell.Value)<br />‘(264)删除字符串前面的空白字符<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveCell.Value &#x3D; LTrim(ActiveCell.Value)<br />‘(265)获取活动单元格中字符串的个数<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Len(ActiveCell.Value)<br />‘(266)将当前单元格中的字符转换成大写<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveCell.Value &#x3D; UCase(ActiveCell.Value)<br />‘(267)将活动单元格中的字符串转换成小写<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveCell.Value &#x3D; StrConv(ActiveCell.Value, vbLowerCase)<br />‘(268)在当前工作表的单元格C1中添加批注<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Range(“C1”).AddComment<br />‘(269)获取今天的星期,以数值表示,1-7分别对应星期日至星期六<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Weekday (Date)<br />‘(270)将单元格A1的数值填充到单元格A1至A10区域中<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Range(“A1”).AutoFill Range(Cells(1, 1), Cells(10, 1))<br />‘(271)获取今天在全年中的天数<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DatePart(“y”, Date)<br />‘(272)获取两年后的今天的日期<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveCell.Value &#x3D; DateAdd(“yyyy”, 2, Date)<br />‘(273)获取今天的星期数<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MsgBox WeekdayName(Weekday(Date))<br />‘(274)在当前单元格中输入今年的年份数<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveCell.Value &#x3D; Year(Date)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’在当前单元格中输入今天所在的月份数<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveCell.Value &#x3D; Month(Date)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’在当前单元格中输入今天的日期数<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveCell.Value &#x3D; Day(Date)<br />‘(275)在当前单元格中显示月份的名称,本句为显示”一月”<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveCell.Value &#x3D; MonthName(1)<br />‘(276)在当前单元格中显示现在时间的小时数<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveCell.Value &#x3D; Hour(Time)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’在当前单元格中显示现在时间的分钟数<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveCell.Value &#x3D; Minute(Time)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’在当前单元格中显示现在时间的秒数<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveCell.Value &#x3D; Second(Time)<br />‘(277)删除当前工作表中的第一个形状<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Shapes(1).Del&#101;te<br />‘(278)获取当前工作表中形状的数量<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Shapes.Count<br />‘(279)改变当前工作表中第一个艺术字的方向<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Shapes(1).TextEffect.ToggleVerticalText<br />‘(280)将当前工作表中第一个艺术字的字体设置为斜体<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Shapes(1).TextEffect.FontItalic &#x3D; True<br />‘(281)在当前工作表中创建一个名为”三峡”的艺术字并对其进行格式设置和选中<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ActiveSheet.Shapes.AddTextEffect(msoTextEffect21, “三峡”, _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;”Arial Black”, 22#, msoFalse, msoFalse, 66#, 80).Sel&#101;ct<br />‘(282)在当前工作表中以(10,10)为起点(250,100)为终点画一条直线并选中<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ActiveSheet.Shapes.AddLine(BeginX:&#x3D;10, BeginY:&#x3D;10, EndX:&#x3D;250, _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EndY:&#x3D;100).Sel&#101;ct<br />‘(283)在当前工作表中画一个左上角在(70,40),宽为130高为72的三角形并选中<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ActiveSheet.Shapes.AddShape(Type:&#x3D;msoShapeRightTriangle, _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Left:&#x3D;70, Top:&#x3D;40, Width:&#x3D;130, Height:&#x3D;72).Sel&#101;ct<br />‘(284)在当前工作表中画一个以点(70,40)为起点,宽130高72的矩形并选中<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ActiveSheet.Shapes.AddShape(Type:&#x3D;msoShapeRectangle, _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Left:&#x3D;70, Top:&#x3D;40, Width:&#x3D;130, Height:&#x3D;72).Sel&#101;ct<br />‘(285)在当前工作表中画一个左上角在(70,40),宽为130高为72的椭圆<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ActiveSheet.Shapes.AddShape(Type:&#x3D;msoShapeOval, _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Left:&#x3D;70, Top:&#x3D;40, Width:&#x3D;130, Height:&#x3D;72).Sel&#101;ct<br />‘(286)将当前工作表中第一个形状的线条颜色变为蓝色<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Shapes(1).Line.ForeColor.RGB &#x3D; RGB(0, 0, 255)<br />‘(287)将当前工作表中第2个形状的前景色设置为红色<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Shapes(2).Fill.ForeColor.RGB &#x3D; RGB(255, 0, 0)<br />‘(288)将当前工作表中的第1个形状旋转20度<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Shapes(1).Rotation &#x3D; 20<br />‘(289)将当前选中的形状水平翻转<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sel&#101;ction.ShapeRange.Flip msoFlipHorizontal<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’将当前选中的形状垂直翻转<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sel&#101;ction.ShapeRange.Flip msoFlipVertical<br />‘(290)将所选取的形状设置为第1种立体样式<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sel&#101;ction.ShapeRange.ThreeD.SetThreeDFormat msoThreeD1<br />‘(291)将当前工作表中第一个立体形状的深度设置为20<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Shapes(1).ThreeD.Depth &#x3D; 20<br />‘(292)将当前工作表中第1个立体形状的进深部分的颜色设为蓝色<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Shapes(1).ThreeD.ExtrusionColor.RGB &#x3D; RGB(0, 0, 255)<br />‘(293)将当前工作表中的第1个立体形状沿X轴旋转60度<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Shapes(1).ThreeD.RotationX &#x3D; 60<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’将当前工作表中的第1个立体形状沿Y轴旋转60度<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Shapes(1).ThreeD.RotationY &#x3D; 60<br />‘(294)将所选择的立体形状转换为平面形状<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sel&#101;ction.ShapeRange.ThreeD.Visible &#x3D; msoFalse<br />‘(295)在形状中让指定的连接符起点脱离原来所连接的形状<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sel&#101;ction.ShapeRange.ConnectorFormat.BeginDisconnect<br />‘(296)复制当前工作表中形状1的格式<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Shapes(1).PickUp<br />‘(297)在工作簿中新建一个文本框并输入内容<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Shapes.AddTextbox(msoTextOrientationHorizontal, 260, 160, 180, 30).TextFrame.Characters.Text &#x3D; _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;”fanjy.blog.excelhome.net”<br />‘(298)在当前工作表中建立一个水平文本框并输入内容<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Shapes.AddLabel(msoTextOrientationHorizontal, 20, 80, 100, 200).TextFrame.Characters.Text &#x3D; _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;”fanjy.blog.excelhome.net”<br />‘(299)在当前工作表中插入一张d盘中名为sx的图片<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveSheet.Shapes.AddPicture “d:sx.jpg”, True, True, 60, 20, 400, 300<br />‘(300)将当前图表类型改为三维面积图<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveChart.ApplyCustomType xl3DArea<br /><br /></p>
</div><div class="tags"></div><div class="post-nav"><a class="pre" href="/2006/12/02/98-VBA%E8%AF%AD%E5%8F%A5%E9%9B%86100%E5%8F%A5(%E7%AC%AC4%E8%BE%91WordVBA)/">VBA语句集100句(第4辑WordVBA)</a><a class="next" href="/2006/10/04/5-%E5%AE%9E%E7%94%A8%E5%B7%A5%E5%85%B7:%E5%B8%B8%E7%94%A8%E6%95%B0%E5%AD%A6%E5%85%AC%E5%BC%8F/">实用工具:常用数学公式</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="https://anthoney.github.io"/></form></div><div class="widget"><div class="author-info"><a class="info-avatar" href="/about/" title="关于"><img class="nofancybox" src="/img/avatar.png"/></a><p>To be a better man.</p><a class="info-icon" href="https://twitter.com/yontaw" title="Twitter" target="_blank" style="margin-inline:5px"> <i class="fa fa-twitter-square" style="margin-inline:5px"></i></a><a class="info-icon" href="mailto:admin@from2.net" title="Email" target="_blank" style="margin-inline:5px"> <i class="fa fa-envelope-square" style="margin-inline:5px"></i></a><a class="info-icon" href="https://github.com/anthoney" title="Github" target="_blank" style="margin-inline:5px"> <i class="fa fa-github-square" style="margin-inline:5px"></i></a><a class="info-icon" href="/atom.xml" title="RSS" target="_blank" style="margin-inline:5px"> <i class="fa fa-rss-square" style="margin-inline:5px"></i></a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/GIS/">GIS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%BA%BA%E6%96%87%E5%9C%B0%E7%90%86/">人文地理</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%90%83%E5%96%9D%E7%8E%A9%E4%B9%90/">吃喝玩乐</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%A4%96%E8%AF%AD/">外语</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%BD%B1%E9%9F%B3%E5%9B%BE%E5%BD%A2/">影音图形</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%BF%83%E8%B7%AF/">心路</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9D%82%E8%B0%88/">杂谈</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%BD%AF%E4%BB%B6%E6%8A%80%E6%9C%AF/">软件技术</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%A3%9E%E8%A1%8C%E6%A2%A6%E6%83%B3/">飞行梦想</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2021/09/30/455-FlexNet%20lmtools%20license%20vitual%20adapter%20Revit%E9%85%8D%E7%BD%AE%E8%99%9A%E6%8B%9F%E7%BD%91%E5%8D%A1/">FlexNet lmtools license vitual adapter Revit配置虚拟网卡</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/08/454-%E6%88%BF%E5%B1%8B%E5%9D%90%E5%90%91%E4%BB%A5%E4%BB%80%E4%B9%88%E4%B8%BA%E5%87%86%20%E6%88%BF%E5%B1%8B%E5%9D%90%E5%90%91%E6%80%8E%E4%B9%88%E7%9C%8B/">房屋坐向以什么为准 房屋坐向怎么看</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/01/12/453-FME%20Desktop%202021%20for%20Mac%E5%AE%89%E8%A3%85%E8%B8%A9%E5%9D%91%E6%95%99%E7%A8%8B/">FME Desktop 2021 for Mac安装踩坑教程</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04/29/452-%E4%BF%9D%E5%8F%B7google%20voice%E9%99%84%E4%BD%BF%E7%94%A8%E5%BB%BA%E8%AE%AE/">保号google voice附使用建议</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/14/451-5G%20Wifi%20Router%20Band%20Channel%20limit%E4%BF%AE%E6%94%B95GWIFI%E8%B7%AF%E7%94%B1%E4%B8%AD%E5%9B%BD%E9%A2%91%E6%AE%B5%E9%99%90%E5%88%B6/">5G Wifi Router Band Channel limit修改5GWIFI路由中国频段限制</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/22/450-%E8%80%81%E6%AC%BEiPhone%E5%8F%98%E6%85%A2%E5%8D%A1%E9%A1%BF%E6%8E%89%E5%B8%A7%E5%8F%91%E7%83%AD%E5%88%87%E6%8D%A2%E8%BF%9F%E7%BC%93%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95%E5%88%86%E4%BA%AB/">老款iPhone变慢卡顿掉帧发热切换迟缓解决方法分享</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/12/13/449-python%E4%B8%AD%E6%96%87%E5%AD%97%E7%AC%A6%E4%B9%B1%E7%A0%81%E8%A7%A3%E5%86%B3%E5%81%8F%E6%96%B9/">python中文字符乱码解决偏方</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/06/02/448-Python%20opencv%20error%20215%20imshow%20%E9%97%AE%E9%A2%98/">Python opencv error 215 imshow 问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/04/04/447-python%20faild_install_package%20%E6%8A%A5%E9%94%99%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/">python faild_install_package 报错解决办法</a></li><li class="post-list-item"><a class="post-list-link" href="/2013/06/16/446-%E5%8F%A4%E5%85%B8%E8%AF%97%E8%AF%8D/">古典诗词</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2023 <a href="/." rel="nofollow">from2.net.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.js"></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.0"></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.css"><script type="text/javascript" src="/js/copycode.js?v=1.0.0" successtext="复制成功！"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css?v=1.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>