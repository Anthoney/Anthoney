<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><title>使用DDE技术 | from2.net</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/latest/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/grids-responsive-min.min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/latest/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script type="text/javascript" src="//lib.baomitu.com/clipboard.js/latest/clipboard.min.js"></script><script type="text/javascript" src="//lib.baomitu.com/toastr.js/latest/toastr.min.js"></script><link rel="stylesheet" href="//lib.baomitu.com/toastr.js/latest/toastr.min.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">使用DDE技术</h1><a id="logo" href="/.">from2.net</a><p class="description"></p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">使用DDE技术</h1><div class="post-meta">2005-09-12<span> | </span><span class="category"><a href="/categories/%E8%BD%AF%E4%BB%B6%E6%8A%80%E6%9C%AF/">软件技术</a></span></div><div class="post-content"><p>&nbsp;&nbsp;上网的朋友一定都用过网络蚂蚁（Net&nbsp;&nbsp; Ants）的吧？不知你在使用过程中有没有注意过，&nbsp;&nbsp; <br />&nbsp;&nbsp;那就是如果你想调动两个“蚂蚁”为您效力是不可能的——它总会把新运行的关闭。&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;而“蚂蚁”程序的妙处就在于：在重复运行“蚂蚁”时它不仅拒绝运行，而且能把已经运&nbsp;&nbsp; <br />&nbsp;&nbsp;行的“蚂蚁”激活，这样用上面的程序就无能为力了。但事实上实现拒绝运行并激活已运行的&nbsp;&nbsp; <br />&nbsp;&nbsp;程序有多种方法：&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1、用FindWindow函数得到已经运行窗体的句柄（HWND），然后用SetActiveWindow等API函&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;数将其激活。其缺点也很明显，那就是没法传递参数。&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2、用FindWindow函数得到已运行窗体的句柄后用SendMessage的方法给窗体传送一个自定义&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;消息（附带参数），然后在窗体中拦截并进行处理，但这样做要修改窗体的标准消息处理&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;程序，用在VC，BC或DELPHI编写的程序中还行，但在VB中工作量太大，并且容易发生“一&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;般保护行错误”使VB崩溃，不太可取（当然，如果你有足够的信心和不怕崩溃的精神，也&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;可以试一下&nbsp;&nbsp; ^_^&nbsp;&nbsp; ）。&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3、使用DDE技术。&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;所谓DDE技术，就是动态数据交换技术。也许你很奇怪，这与本文所讨论的内容有什么相干的？&nbsp;&nbsp; <br />&nbsp;&nbsp;且听我慢慢讲来。&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;为了实现拒绝运行并把已经运行的程序激活并实现各种功能，我们可以先用本文开头提到的方&nbsp;&nbsp; <br />&nbsp;&nbsp;法，检测一下程序有没有被运行过，如果没有，就正常运行，如果已经被运行过，就打通与它的&nbsp;&nbsp; <br />&nbsp;&nbsp;DDE通道，传给它一个（或一些）数据，然后由已经运行的程序对数据进行处理，再去实现各种&nbsp;&nbsp; <br />&nbsp;&nbsp;“意想不到”的功能，这时也许就有人对这你的程序喊：“酷、酷……”&nbsp;&nbsp;&nbsp;&nbsp; ^_^&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;好了，耳听为虚，眼见为实，下面让我们动点真格的。&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;打开VB，新建一个工程，选择菜单中的“工程-&gt;工程1&nbsp;&nbsp; 属性”，把工程名称改为“P1”（我爱&nbsp;&nbsp; <br />&nbsp;&nbsp;偷懒，能短则短&nbsp;&nbsp; ^_^&nbsp;&nbsp; ），把已有的一个窗体的“LinkTopic”属性改为“FormDDE”，把“LinkMode”&nbsp;&nbsp; <br />&nbsp;&nbsp;属性改为“1&nbsp;&nbsp; -&nbsp;&nbsp; Source”，添加一个PictureBox控件作为DDE执行控件，命名为picDDE。然后添加一个&nbsp;&nbsp; <br />&nbsp;&nbsp;TextBox控件，命名为“txtInfo”，并把“MultiLine”属性设置为“True”，以便显示多行文本，作为&nbsp;&nbsp; <br />&nbsp;&nbsp;消息显示控件。&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;最后在窗体代码区输入以下代码：&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;<br /> Const COMMANDLINE &#x3D; “CommandLine&#x3D;”&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’注释：&nbsp;&nbsp;&nbsp;&nbsp; 还是为了省事，定义一个常量<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;Private Sub Form_LinkExecute(CmdStr As String, Cancel As Integer)<br />&nbsp;&nbsp;Static lngCount&nbsp;&nbsp;&nbsp;&nbsp; As Long<br />&nbsp;&nbsp;Dim Info&nbsp;&nbsp;&nbsp;&nbsp; As String<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;Info &#x3D; txtInfo.Text&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‘注释：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 保留原有信息<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;Sel&#101;ct Case CmdStr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’注释：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CmdStr&nbsp;&nbsp; 是DDE程序传送过来的参数<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case “Max”<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Me.WindowState &#x3D; 2<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Info &#x3D; Info + vbNewLine + “窗体已被最大化”<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case “ShowTime”<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Info &#x3D; Info + vbNewLine + “最后一次运行这个程序的时间是：” + Str(Now)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case “Count”<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lngCount &#x3D; lngCount + 1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Info &#x3D; Info + vbNewLine + “你已经第” + Str(lngCount) + “次重复调用这个程序。” _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ vbNewLine + “但怕您不多给工资，所以只运行了一个&nbsp;&nbsp; ^_^”<br />&nbsp;&nbsp;End Sel&#101;ct<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;If Left(CmdStr, Len(COMMANDLINE)) &#x3D; COMMANDLINE Then<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Info &#x3D; Info + vbNewLine + “新程序曾以命令行形式运行” + vbNewLine + “命令行为：” _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ vbNewLine + Right(CmdStr, Len(CmdStr) - Len(COMMANDLINE))<br />&nbsp;&nbsp;End If<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;txtInfo.Text &#x3D; Info&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‘注释：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 把信息显示出来<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;Cancel &#x3D; False<br />&nbsp;&nbsp;End Sub<br /><br />&nbsp;&nbsp;Private Sub LinkAndSendMessage(ByVal Msg As String)<br />&nbsp;&nbsp;&nbsp;&nbsp;Dim t&nbsp;&nbsp;&nbsp;&nbsp; As Long<br />&nbsp;&nbsp;&nbsp;&nbsp;picDDE.LinkMode &#x3D; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‘注释：–<br />&nbsp;&nbsp;&nbsp;&nbsp;picDDE.LinkTopic &#x3D; “P1|FormDDE”&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‘注释：&nbsp;&nbsp;&nbsp;&nbsp; |_连接DDE程序并发送数据&#x2F;参数<br />&nbsp;&nbsp;&nbsp;&nbsp;picDDE.LinkMode &#x3D; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‘注释：&nbsp;&nbsp;&nbsp;&nbsp; |“|”为管道符，是“退格键”旁边的竖线，<br />&nbsp;&nbsp;&nbsp;&nbsp;picDDE.LinkExecute Msg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’注释：–&nbsp;&nbsp;&nbsp;&nbsp; 不是字母或数字！<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;t &#x3D; picDDE.LinkTimeout&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’注释：–<br />&nbsp;&nbsp;&nbsp;&nbsp;picDDE.LinkTimeout &#x3D; 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’注释：&nbsp;&nbsp;&nbsp;&nbsp; |_终止DDE通道。当然，也可以用别的方法<br />&nbsp;&nbsp;&nbsp;&nbsp;picDDE.LinkMode &#x3D; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‘注释：&nbsp;&nbsp;&nbsp;&nbsp; | 这里用的是超时强制终止的方法<br />&nbsp;&nbsp;&nbsp;&nbsp;picDDE.LinkTimeout &#x3D; t&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’注释：–<br />&nbsp;&nbsp;End Sub<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;Private Sub Form_Load()<br />&nbsp;&nbsp;If App.PrevInstance Then&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’注释:&nbsp;&nbsp;&nbsp;&nbsp; 程序是否已经运行<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Me.LinkTopic &#x3D; “”&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‘注释：&nbsp;&nbsp; 这两行用于清除新运行的程序的DDE服务器属性，<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Me.LinkMode &#x3D; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‘注释：&nbsp;&nbsp; 否则在连接DDE程序时会出乱子的<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LinkAndSendMessage “Max”&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’注释：–<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LinkAndSendMessage “Count”&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;’注释： |—–连接DDE接受程序并传送数据&#x2F;参数<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LinkAndSendMessage “ShowTime”&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‘注释：–<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If Command &lt;&gt; “” Then&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‘注释：&nbsp;&nbsp; 如果有命令行参数，就传递过去<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LinkAndSendMessage COMMANDLINE + Command<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‘注释：&nbsp;&nbsp;&nbsp;&nbsp; 结束新程序的运行<br />&nbsp;&nbsp;End If<br />&nbsp;&nbsp;End Sub<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;测试一下：&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;把工程“P1”编译成EXE文件（设名称为&nbsp;&nbsp; P1.EXE&nbsp;&nbsp; ）&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1、打开“我的电脑”，找到&nbsp;&nbsp; P1.EXE&nbsp;&nbsp; 并执行。可以看到程序正常运行了。&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2、再运行一次，这次新程序没有运行成功，而原来运行的程序却被最大化了，而且文本框中有以下&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;字符：&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;窗体已被最大化&nbsp;&nbsp; <br />&nbsp;&nbsp;你已经第&nbsp;&nbsp; 1次重复调用这个程序。&nbsp;&nbsp; <br />&nbsp;&nbsp;但怕您不多给工资，所以只运行了一个&nbsp;&nbsp; ^_^&nbsp;&nbsp; <br />&nbsp;&nbsp;最后一次运行这个程序的时间是：00-2-6&nbsp;&nbsp; 7:11:01&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3、打开&nbsp;&nbsp; MS-DOS方式&nbsp;&nbsp; ，用命令行方式再次运行程序，如&nbsp;&nbsp; “P1&nbsp;&nbsp; How&nbsp;&nbsp; Are&nbsp;&nbsp; You?”&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;这时原来运行的程序文本框中又多了几行字：&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;窗体已被最大化&nbsp;&nbsp; <br />&nbsp;&nbsp;你已经第&nbsp;&nbsp; 2次重复调用这个程序。&nbsp;&nbsp; <br />&nbsp;&nbsp;但怕您不多给工资，所以只运行了一个&nbsp;&nbsp; ^_^&nbsp;&nbsp; <br />&nbsp;&nbsp;最后一次运行这个程序的时间是：00-2-6&nbsp;&nbsp; 7:14:32&nbsp;&nbsp; <br />&nbsp;&nbsp;新程序曾以命令行形式运行&nbsp;&nbsp; <br />&nbsp;&nbsp;命令行为：&nbsp;&nbsp; <br />&nbsp;&nbsp;How&nbsp;&nbsp; Are&nbsp;&nbsp; You?&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;OK，运行完全正确，然后你就可以把它应用的你的程序中了。&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;当然，这只是一些个人心得，如有疏漏之出，还请各位大虾指正。&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;以上代码保存于：&nbsp;&nbsp; SourceCode&nbsp;&nbsp; Explorer(源代码数据库)&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;复制时间：&nbsp;&nbsp; 2005-09-12&nbsp;&nbsp; 13:03:45&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;软件版本：&nbsp;&nbsp; 1.0.880&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;软件作者：&nbsp;&nbsp; Shawls&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E-Mail：&nbsp;&nbsp; <a href="mailto:&#83;&#104;&#97;&#x77;&#70;&#105;&#108;&#101;&#64;&#49;&#x36;&#51;&#46;&#x63;&#111;&#x6d;">&#83;&#104;&#97;&#x77;&#70;&#105;&#108;&#101;&#64;&#49;&#x36;&#51;&#46;&#x63;&#111;&#x6d;</a>&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QQ：&nbsp;&nbsp; 9181729</p>
</div><div class="tags"></div><div class="post-nav"><a class="pre" href="/2006/01/20/7-%E6%9C%89%E5%85%B3Oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%A4%87%E4%BB%BD%E6%83%85%E5%86%B5/">有关Oracle数据库的备份情况</a><a class="next" href="/2005/05/19/101-IRC%E6%89%AB%E7%9B%B2%E2%80%94%E2%80%94%E4%BD%A0%E5%8F%AF%E4%BB%A5%E4%B8%8D%E4%BC%9A%E7%8E%A9QQ%EF%BC%8C%E4%BD%86%E4%B8%8D%E8%83%BD%E4%B8%8D%E4%BC%9AIRC%EF%BC%81/">IRC扫盲——你可以不会玩QQ，但不能不会IRC！</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="https://anthoney.github.io"/></form></div><div class="widget"><div class="author-info"><a class="info-avatar" href="/about/" title="关于"><img class="nofancybox" src="/img/avatar.png"/></a><p>To be a better man.</p><a class="info-icon" href="https://twitter.com/yontaw" title="Twitter" target="_blank" style="margin-inline:5px"> <i class="fa fa-twitter-square" style="margin-inline:5px"></i></a><a class="info-icon" href="mailto:admin@from2.net" title="Email" target="_blank" style="margin-inline:5px"> <i class="fa fa-envelope-square" style="margin-inline:5px"></i></a><a class="info-icon" href="https://github.com/anthoney" title="Github" target="_blank" style="margin-inline:5px"> <i class="fa fa-github-square" style="margin-inline:5px"></i></a><a class="info-icon" href="/atom.xml" title="RSS" target="_blank" style="margin-inline:5px"> <i class="fa fa-rss-square" style="margin-inline:5px"></i></a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/GIS/">GIS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%BA%BA%E6%96%87%E5%9C%B0%E7%90%86/">人文地理</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%90%83%E5%96%9D%E7%8E%A9%E4%B9%90/">吃喝玩乐</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%A4%96%E8%AF%AD/">外语</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%BD%B1%E9%9F%B3%E5%9B%BE%E5%BD%A2/">影音图形</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%BF%83%E8%B7%AF/">心路</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9D%82%E8%B0%88/">杂谈</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%BD%AF%E4%BB%B6%E6%8A%80%E6%9C%AF/">软件技术</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%A3%9E%E8%A1%8C%E6%A2%A6%E6%83%B3/">飞行梦想</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2021/09/30/455-FlexNet%20lmtools%20license%20vitual%20adapter%20Revit%E9%85%8D%E7%BD%AE%E8%99%9A%E6%8B%9F%E7%BD%91%E5%8D%A1/">FlexNet lmtools license vitual adapter Revit配置虚拟网卡</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/08/454-%E6%88%BF%E5%B1%8B%E5%9D%90%E5%90%91%E4%BB%A5%E4%BB%80%E4%B9%88%E4%B8%BA%E5%87%86%20%E6%88%BF%E5%B1%8B%E5%9D%90%E5%90%91%E6%80%8E%E4%B9%88%E7%9C%8B/">房屋坐向以什么为准 房屋坐向怎么看</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/01/12/453-FME%20Desktop%202021%20for%20Mac%E5%AE%89%E8%A3%85%E8%B8%A9%E5%9D%91%E6%95%99%E7%A8%8B/">FME Desktop 2021 for Mac安装踩坑教程</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04/29/452-%E4%BF%9D%E5%8F%B7google%20voice%E9%99%84%E4%BD%BF%E7%94%A8%E5%BB%BA%E8%AE%AE/">保号google voice附使用建议</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/14/451-5G%20Wifi%20Router%20Band%20Channel%20limit%E4%BF%AE%E6%94%B95GWIFI%E8%B7%AF%E7%94%B1%E4%B8%AD%E5%9B%BD%E9%A2%91%E6%AE%B5%E9%99%90%E5%88%B6/">5G Wifi Router Band Channel limit修改5GWIFI路由中国频段限制</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/22/450-%E8%80%81%E6%AC%BEiPhone%E5%8F%98%E6%85%A2%E5%8D%A1%E9%A1%BF%E6%8E%89%E5%B8%A7%E5%8F%91%E7%83%AD%E5%88%87%E6%8D%A2%E8%BF%9F%E7%BC%93%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95%E5%88%86%E4%BA%AB/">老款iPhone变慢卡顿掉帧发热切换迟缓解决方法分享</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/12/13/449-python%E4%B8%AD%E6%96%87%E5%AD%97%E7%AC%A6%E4%B9%B1%E7%A0%81%E8%A7%A3%E5%86%B3%E5%81%8F%E6%96%B9/">python中文字符乱码解决偏方</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/06/02/448-Python%20opencv%20error%20215%20imshow%20%E9%97%AE%E9%A2%98/">Python opencv error 215 imshow 问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/04/04/447-python%20faild_install_package%20%E6%8A%A5%E9%94%99%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/">python faild_install_package 报错解决办法</a></li><li class="post-list-item"><a class="post-list-link" href="/2013/06/16/446-%E5%8F%A4%E5%85%B8%E8%AF%97%E8%AF%8D/">古典诗词</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2023 <a href="/." rel="nofollow">from2.net.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.js"></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.0"></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.css"><script type="text/javascript" src="/js/copycode.js?v=1.0.0" successtext="复制成功！"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css?v=1.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>