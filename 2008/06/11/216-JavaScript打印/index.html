<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><title>JavaScript打印 | from2.net</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/latest/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/grids-responsive-min.min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/latest/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script type="text/javascript" src="//lib.baomitu.com/clipboard.js/latest/clipboard.min.js"></script><script type="text/javascript" src="//lib.baomitu.com/toastr.js/latest/toastr.min.js"></script><link rel="stylesheet" href="//lib.baomitu.com/toastr.js/latest/toastr.min.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">JavaScript打印</h1><a id="logo" href="/.">from2.net</a><p class="description"></p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">JavaScript打印</h1><div class="post-meta">2008-06-11<span> | </span><span class="category"><a href="/categories/%E8%BD%AF%E4%BB%B6%E6%8A%80%E6%9C%AF/">软件技术</a></span></div><div class="post-content"><p><font size="2"><strong>&#x2F;&#x2F;打印分页</strong> </font></p>
<p>&nbsp;</p>
<p><br /><font size="2"><strong>//设置打印</strong> <br /></font></p>
<font size="2">
<div style="BORDER-RIGHT: rgb(138,138,138) 1px solid; PADDING-RIGHT: 4px; BORDER-TOP: rgb(138,138,138) 1px solid; PADDING-LEFT: 4px; FONT-SIZE: 12px; PADDING-BOTTOM: 4px; MARGIN: 4px; OVERFLOW: auto; BORDER-LEFT: rgb(138,138,138) 1px solid; PADDING-TOP: 4px; BORDER-BOTTOM: rgb(138,138,138) 1px solid; BACKGROUND-COLOR: rgb(238,238,238);">&lt;object id=<span style="COLOR: rgb(255,0,255);">"factory"</span> style=<span style="COLOR: rgb(255,0,255);">"display:none"</span> viewastext <br />&nbsp;&nbsp; classid=<span style="COLOR: rgb(255,0,255);">"clsid:1663ed61-23eb-11d2-b92f-008048fdd814"</span> <br />&nbsp;&nbsp; codebase=<span style="COLOR: rgb(255,0,255);">"http:<span style="COLOR: rgb(0,128,0);">//www.meadroid.com/scriptx/ScriptX.cab#Version=5,60,0,360"</span> </span><br />&gt;&lt;/object&gt; <br />&lt;input type=button value=页面设置 onclick=<span style="COLOR: rgb(255,0,255);">"factory.printing.PageSetup()"</span>&gt; <br />&lt;input type=button value=打印预览 onclick=<span style="COLOR: rgb(255,0,255);">"factory.printing.Preview()"</span>&gt; <br /><br />&lt;script language=javascript&gt; <br /><span style="COLOR: rgb(0,0,255);">function</span> window.onload() <br />{ <br />&nbsp;&nbsp;&nbsp;<span style="COLOR: rgb(0,128,0);">// -- advanced features </span><br />&nbsp;&nbsp;&nbsp; factory.printing.SetMarginMeasure(2) <span style="COLOR: rgb(0,128,0);">// measure margins in inches </span><br />&nbsp;&nbsp;&nbsp; factory.printing.SetPageRange(<span style="COLOR: rgb(0,0,255);">false</span>, 1, 3) <span style="COLOR: rgb(0,128,0);">// need pages from 1 to 3 </span><br />&nbsp;&nbsp;&nbsp; factory.printing.printer = <span style="COLOR: rgb(255,0,255);">"HP DeskJet 870C"</span> <br />&nbsp;&nbsp;&nbsp; factory.printing.copies = 2 <br />&nbsp;&nbsp;&nbsp; factory.printing.collate = true <br />&nbsp;&nbsp;&nbsp; factory.printing.paperSize = <span style="COLOR: rgb(255,0,255);">"A4"</span> <br />&nbsp;&nbsp;&nbsp; factory.printing.paperSource = <span style="COLOR: rgb(255,0,255);">"Manual feed"</span> <br />&nbsp;&nbsp;&nbsp;<span style="COLOR: rgb(0,128,0);">// -- basic features </span><br />&nbsp;&nbsp;&nbsp; factory.printing.header = <span style="COLOR: rgb(255,0,255);">"居左显示&amp;b居中显示&amp;b居右显示页码，第&amp;p页/共&amp;P页"</span> <br />&nbsp;&nbsp;&nbsp; factory.printing.footer = <span style="COLOR: rgb(255,0,255);">"（自定义页脚）"</span> <br />&nbsp;&nbsp;&nbsp; factory.printing.portrait = false <br />&nbsp;&nbsp;&nbsp; factory.printing.leftMargin = 0.75 <br />&nbsp;&nbsp;&nbsp; factory.printing.topMargin = 1.5 <br />&nbsp;&nbsp;&nbsp; factory.printing.rightMargin = 0.75 <br />&nbsp;&nbsp;&nbsp; factory.printing.bottomMargin = 1.5 <br />} <br /><span style="COLOR: rgb(0,0,255);">function</span> Print(frame) { <br />&nbsp;&nbsp; factory.printing.Print(<span style="COLOR: rgb(0,0,255);">true</span>, frame) <span style="COLOR: rgb(0,128,0);">// print with prompt </span><br />} <br />&lt;/script&gt; <br />&lt;input type=button value=<span style="COLOR: rgb(255,0,255);">"打印本页"</span> onclick=<span style="COLOR: rgb(255,0,255);">"factory.printing.Print(false)"</span>&gt; <br />&lt;input type=button value=<span style="COLOR: rgb(255,0,255);">"页面设置"</span> onclick=<span style="COLOR: rgb(255,0,255);">"factory.printing.PageSetup()"</span>&gt; <br />&lt;input type=button value=<span style="COLOR: rgb(255,0,255);">"打印预览"</span> onclick=<span style="COLOR: rgb(255,0,255);">"factory.printing.Preview()"</span>&gt;&lt;br&gt; <br />&lt;a href=<span style="COLOR: rgb(255,0,255);">"http:<span style="COLOR: rgb(0,128,0);">//www.meadroid.com/scriptx/docs/printdoc.htm?static"</span>&nbsp;&nbsp; target=_blank&gt;具体使用手册，更多信息，点这里&lt;/a&gt; </span></div>
<p><strong>//自带的打印预览</strong></p>
</font><font size="2">
<div style="BORDER-RIGHT: rgb(138,138,138) 1px solid; PADDING-RIGHT: 4px; BORDER-TOP: rgb(138,138,138) 1px solid; PADDING-LEFT: 4px; FONT-SIZE: 12px; PADDING-BOTTOM: 4px; MARGIN: 4px; OVERFLOW: auto; BORDER-LEFT: rgb(138,138,138) 1px solid; PADDING-TOP: 4px; BORDER-BOTTOM: rgb(138,138,138) 1px solid; BACKGROUND-COLOR: rgb(238,238,238);">WebBrowser.ExecWB(1,1) 打开 <br />Web.ExecWB(2,1) 关闭现在所有的IE窗口，并打开一个新窗口 <br />Web.ExecWB(4,1) 保存网页 <br />Web.ExecWB(6,1) 打印 <br />Web.ExecWB(7,1) 打印预览 <br />Web.ExecWB(8,1) 打印页面设置 <br />Web.ExecWB(10,1) 查看页面属性 <br />Web.ExecWB(15,1) 好像是撤销，有待确认 <br />Web.ExecWB(17,1) 全选 <br />Web.ExecWB(22,1) 刷新 <br />Web.ExecWB(45,1) 关闭窗体无提示 <br />&lt;style media=print&gt; <br />.Noprint{display:none;}&lt;!--用本样式在打印时隐藏非打印项目--&gt; <br />.PageNext{page-break-after: always;}&lt;!--控制分页--&gt; <br />&lt;/style&gt; <br />&lt;object&nbsp;&nbsp; id=<span style="COLOR: rgb(255,0,255);">"WebBrowser"</span>&nbsp;&nbsp; width=0&nbsp;&nbsp; height=0&nbsp;&nbsp; classid=<span style="COLOR: rgb(255,0,255);">"CLSID:8856F961-340A-11D0-A96B-00C04FD705A2"</span>&gt;&nbsp;&nbsp;&nbsp;&nbsp; <br />&lt;/object&gt;&nbsp;&nbsp;&nbsp;&nbsp; <br /><br />&lt;center class=<span style="COLOR: rgb(255,0,255);">"Noprint"</span> &gt; <br />&lt;input type=button value=打印 onclick=document.all.WebBrowser.ExecWB(6,1)&gt; <br />&lt;input type=button value=直接打印 onclick=document.all.WebBrowser.ExecWB(6,6)&gt; <br />&lt;input type=button value=页面设置 onclick=document.all.WebBrowser.ExecWB(8,1)&gt; <br />&lt;/p&gt; <br />&lt;p&gt; &lt;input type=button value=打印预览 onclick=document.all.WebBrowser.ExecWB(7,1)&gt; <br />&lt;/center&gt;</div>
</font>
<p><font size="2"><strong>//去掉打印时的页眉页脚</strong> <br /></font></p>
<font size="2">
<div style="BORDER-RIGHT: rgb(138,138,138) 1px solid; PADDING-RIGHT: 4px; BORDER-TOP: rgb(138,138,138) 1px solid; PADDING-LEFT: 4px; FONT-SIZE: 12px; PADDING-BOTTOM: 4px; MARGIN: 4px; OVERFLOW: auto; BORDER-LEFT: rgb(138,138,138) 1px solid; PADDING-TOP: 4px; BORDER-BOTTOM: rgb(138,138,138) 1px solid; BACKGROUND-COLOR: rgb(238,238,238);">&lt;script&nbsp;&nbsp; language=<span style="COLOR: rgb(255,0,255);">"JavaScript"</span>&gt;&nbsp;&nbsp; <br /><span style="COLOR: rgb(0,0,255);">var</span> HKEY_Root,HKEY_Path,HKEY_Key; <br />HKEY_Root=<span style="COLOR: rgb(255,0,255);">"HKEY_CURRENT_USER"</span>; <br />HKEY_Path=<span style="COLOR: rgb(255,0,255);">"\\Software\\Microsoft\\Internet Explorer\\PageSetup\\"</span>; <br /><span style="COLOR: rgb(0,128,0);">//设置网页打印的页眉页脚为空 </span><br /><span style="COLOR: rgb(0,0,255);">function</span> PageSetup_Null() <br />{ <br />try <br />{ <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: rgb(0,0,255);">var</span> Wsh=<span style="COLOR: rgb(0,0,255);">new</span> <span style="COLOR: rgb(255,0,0);">ActiveXObject</span>(<span style="COLOR: rgb(255,0,255);">"WScript.Shell"</span>); <br />&nbsp;&nbsp; HKEY_Key=<span style="COLOR: rgb(255,0,255);">"header"</span>; <br />&nbsp;&nbsp; Wsh.RegWrite(HKEY_Root+HKEY_Path+HKEY_Key,<span style="COLOR: rgb(255,0,255);">""</span>); <br />&nbsp;&nbsp; HKEY_Key=<span style="COLOR: rgb(255,0,255);">"footer"</span>; <br />&nbsp;&nbsp; Wsh.RegWrite(HKEY_Root+HKEY_Path+HKEY_Key,<span style="COLOR: rgb(255,0,255);">""</span>); <br />} <br /><span style="COLOR: rgb(0,0,255);">catch</span>(e){} <br />} <br /><span style="COLOR: rgb(0,128,0);">//设置网页打印的页眉页脚为默认值 </span><br /><span style="COLOR: rgb(0,0,255);">function</span>&nbsp;&nbsp; PageSetup_Default() <br />{&nbsp;&nbsp; <br />try <br />{ <br />&nbsp;&nbsp;<span style="COLOR: rgb(0,0,255);">var</span> Wsh=<span style="COLOR: rgb(0,0,255);">new</span> <span style="COLOR: rgb(255,0,0);">ActiveXObject</span>(<span style="COLOR: rgb(255,0,255);">"WScript.Shell"</span>); <br />&nbsp;&nbsp; HKEY_Key=<span style="COLOR: rgb(255,0,255);">"header"</span>; <br />&nbsp;&nbsp; Wsh.RegWrite(HKEY_Root+HKEY_Path+HKEY_Key,<span style="COLOR: rgb(255,0,255);">"&amp;w&amp;b页码,&amp;p/&amp;P"</span>); <br />&nbsp;&nbsp; HKEY_Key=<span style="COLOR: rgb(255,0,255);">"footer"</span>; <br />&nbsp;&nbsp; Wsh.RegWrite(HKEY_Root+HKEY_Path+HKEY_Key,<span style="COLOR: rgb(255,0,255);">"&amp;u&amp;b&amp;d"</span>); <br />} <br /><span style="COLOR: rgb(0,0,255);">catch</span>(e){} <br />} <br />&lt;/script&gt; <br />&lt;input type=<span style="COLOR: rgb(255,0,255);">"button"</span> value=<span style="COLOR: rgb(255,0,255);">"清空页码"</span> onclick=PageSetup_Null()&gt; <br />&lt;input type=<span style="COLOR: rgb(255,0,255);">"button"</span> value=<span style="COLOR: rgb(255,0,255);">"恢复页码"</span> onclick=PageSetup_Default()&gt;</div>
<p><font size="2"><strong>//浏览器验证</strong> <br /></font></p>
</font><font size="2">
<div style="BORDER-RIGHT: rgb(138,138,138) 1px solid; PADDING-RIGHT: 4px; BORDER-TOP: rgb(138,138,138) 1px solid; PADDING-LEFT: 4px; FONT-SIZE: 12px; PADDING-BOTTOM: 4px; MARGIN: 4px; OVERFLOW: auto; BORDER-LEFT: rgb(138,138,138) 1px solid; PADDING-TOP: 4px; BORDER-BOTTOM: rgb(138,138,138) 1px solid; BACKGROUND-COLOR: rgb(238,238,238);"><span style="COLOR: rgb(0,0,255);">function</span> checkBrowser() <br />{ <br />&nbsp;&nbsp;&nbsp;<span style="COLOR: rgb(0,0,255);">this</span>.ver=navigator.appVersion <br />&nbsp;&nbsp;&nbsp;<span style="COLOR: rgb(0,0,255);">this</span>.dom=document.getElementById?1:0 <br />&nbsp;&nbsp;&nbsp;<span style="COLOR: rgb(0,0,255);">this</span>.ie6=(<span style="COLOR: rgb(0,0,255);">this</span>.ver.indexOf(<span style="COLOR: rgb(255,0,255);">"MSIE 6"</span>)&gt;-1 &amp;&amp; <span style="COLOR: rgb(0,0,255);">this</span>.dom)?1:0; <br />&nbsp;&nbsp;&nbsp;<span style="COLOR: rgb(0,0,255);">this</span>.ie5=(<span style="COLOR: rgb(0,0,255);">this</span>.ver.indexOf(<span style="COLOR: rgb(255,0,255);">"MSIE 5"</span>)&gt;-1 &amp;&amp; <span style="COLOR: rgb(0,0,255);">this</span>.dom)?1:0; <br />&nbsp;&nbsp;&nbsp;<span style="COLOR: rgb(0,0,255);">this</span>.ie4=(document.all &amp;&amp; !<span style="COLOR: rgb(0,0,255);">this</span>.dom)?1:0; <br />&nbsp;&nbsp;&nbsp;<span style="COLOR: rgb(0,0,255);">this</span>.ns5=(<span style="COLOR: rgb(0,0,255);">this</span>.dom &amp;&amp; parseInt(<span style="COLOR: rgb(0,0,255);">this</span>.ver) &gt;= 5) ?1:0; <br />&nbsp;&nbsp;&nbsp;<span style="COLOR: rgb(0,0,255);">this</span>.ns4=(document.layers &amp;&amp; !<span style="COLOR: rgb(0,0,255);">this</span>.dom)?1:0; <br />&nbsp;&nbsp;&nbsp;<span style="COLOR: rgb(0,0,255);">this</span>.mac=(<span style="COLOR: rgb(0,0,255);">this</span>.ver.indexOf('Mac') &gt; -1) ?1:0; <br />&nbsp;&nbsp;&nbsp;<span style="COLOR: rgb(0,0,255);">this</span>.ope=(navigator.userAgent.indexOf('Opera')&gt;-1); <br />&nbsp;&nbsp;&nbsp;<span style="COLOR: rgb(0,0,255);">this</span>.ie=(<span style="COLOR: rgb(0,0,255);">this</span>.ie6 || <span style="COLOR: rgb(0,0,255);">this</span>.ie5 || <span style="COLOR: rgb(0,0,255);">this</span>.ie4) <br />&nbsp;&nbsp;&nbsp;<span style="COLOR: rgb(0,0,255);">this</span>.ns=(<span style="COLOR: rgb(0,0,255);">this</span>.ns4 || <span style="COLOR: rgb(0,0,255);">this</span>.ns5) <br />&nbsp;&nbsp;&nbsp;<span style="COLOR: rgb(0,0,255);">this</span>.bw=(<span style="COLOR: rgb(0,0,255);">this</span>.ie6 || <span style="COLOR: rgb(0,0,255);">this</span>.ie5 || <span style="COLOR: rgb(0,0,255);">this</span>.ie4 || <span style="COLOR: rgb(0,0,255);">this</span>.ns5 || <span style="COLOR: rgb(0,0,255);">this</span>.ns4 || <span style="COLOR: rgb(0,0,255);">this</span>.mac || <span style="COLOR: rgb(0,0,255);">this</span>.ope) <br />&nbsp;&nbsp;&nbsp;<span style="COLOR: rgb(0,0,255);">this</span>.nbw=(!<span style="COLOR: rgb(0,0,255);">this</span>.bw) <br />&nbsp;&nbsp;&nbsp;<span style="COLOR: rgb(0,0,255);">return</span> <span style="COLOR: rgb(0,0,255);">this</span>; <br />}</div>
<p><strong>//计算内容宽和高</strong><font size="2"> </font></p>
<p>&nbsp;</p>
<div style="BORDER-RIGHT: rgb(138,138,138) 1px solid; PADDING-RIGHT: 4px; BORDER-TOP: rgb(138,138,138) 1px solid; PADDING-LEFT: 4px; FONT-SIZE: 12px; PADDING-BOTTOM: 4px; MARGIN: 4px; OVERFLOW: auto; BORDER-LEFT: rgb(138,138,138) 1px solid; PADDING-TOP: 4px; BORDER-BOTTOM: rgb(138,138,138) 1px solid; BACKGROUND-COLOR: rgb(238,238,238);">&lt;SCRIPT&nbsp;&nbsp; language=<span style="COLOR: rgb(255,0,255);">"javascript"</span>&gt;&nbsp;&nbsp; <br /><span style="COLOR: rgb(0,0,255);">function</span>&nbsp;&nbsp; test(obj)&nbsp;&nbsp; <br />{&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: rgb(0,0,255);">var</span>&nbsp;&nbsp; range&nbsp;&nbsp; =&nbsp;&nbsp; obj.createTextRange();&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; alert(<span style="COLOR: rgb(255,0,255);">"内容区宽度:&nbsp;&nbsp; "</span>&nbsp;&nbsp; +&nbsp;&nbsp; range.boundingWidth&nbsp;&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +&nbsp;&nbsp;<span style="COLOR: rgb(255,0,255);">"px\r\n内容区高度:&nbsp;&nbsp; "</span>&nbsp;&nbsp; +&nbsp;&nbsp; range.boundingHeight&nbsp;&nbsp; +&nbsp;&nbsp;<span style="COLOR: rgb(255,0,255);">"px"</span>);&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />}&nbsp;&nbsp; <br />&lt;/SCRIPT&gt;&nbsp;&nbsp; <br />&lt;BODY&gt;&nbsp;&nbsp; <br />&lt;Textarea id=<span style="COLOR: rgb(255,0,255);">"txt"</span> height=<span style="COLOR: rgb(255,0,255);">"150"</span>&gt;sdf&lt;/textarea&gt;&lt;INPUT&nbsp;&nbsp; type=<span style="COLOR: rgb(255,0,255);">"button"</span>&nbsp;&nbsp; value=<span style="COLOR: rgb(255,0,255);">"计算内容宽度"</span>&nbsp;&nbsp; onClick=<span style="COLOR: rgb(255,0,255);">"test(txt)"</span>&gt;&nbsp;&nbsp; <br />&lt;/BODY&gt;</div>
<p><strong>//无模式的提示框</strong><font size="2"> </font></p>
<p>&nbsp;</p>
<div style="BORDER-RIGHT: rgb(138,138,138) 1px solid; PADDING-RIGHT: 4px; BORDER-TOP: rgb(138,138,138) 1px solid; PADDING-LEFT: 4px; FONT-SIZE: 12px; PADDING-BOTTOM: 4px; MARGIN: 4px; OVERFLOW: auto; BORDER-LEFT: rgb(138,138,138) 1px solid; PADDING-TOP: 4px; BORDER-BOTTOM: rgb(138,138,138) 1px solid; BACKGROUND-COLOR: rgb(238,238,238);"><span style="COLOR: rgb(0,0,255);">function</span> modelessAlert(Msg) <br />{ <br />&nbsp;&nbsp;&nbsp; window.showModelessDialog(<span style="COLOR: rgb(255,0,255);">"javascript:alert(\""</span>+escape(Msg)+<span style="COLOR: rgb(255,0,255);">"\");window.close();"</span>,<span style="COLOR: rgb(255,0,255);">""</span>,<span style="COLOR: rgb(255,0,255);">"status:no;resizable:no;help:no;dialogHeight:height:30px;dialogHeight:40px;"</span>); <br />}</div>
</font>
<p>&nbsp;</p>
<strong><font size="2">//屏蔽按键</font></strong>
<p>&nbsp;</p>
<font size="2">
<div style="BORDER-RIGHT: rgb(138,138,138) 1px solid; PADDING-RIGHT: 4px; BORDER-TOP: rgb(138,138,138) 1px solid; PADDING-LEFT: 4px; FONT-SIZE: 12px; PADDING-BOTTOM: 4px; MARGIN: 4px; OVERFLOW: auto; BORDER-LEFT: rgb(138,138,138) 1px solid; PADDING-TOP: 4px; BORDER-BOTTOM: rgb(138,138,138) 1px solid; BACKGROUND-COLOR: rgb(238,238,238);">&lt;html&gt; <br />&lt;head&gt; <br />&nbsp;&nbsp; &lt;meta http-equiv=<span style="COLOR: rgb(255,0,255);">"Content-Type"</span> content=<span style="COLOR: rgb(255,0,255);">"text/html; charset=gb2312"</span>&gt; <br />&nbsp;&nbsp; &lt;noscript&gt;&lt;meta http-equiv=<span style="COLOR: rgb(255,0,255);">"refresh"</span> content=<span style="COLOR: rgb(255,0,255);">"0;url=about:noscript"</span>&gt;&lt;/noscript&gt; <br />&nbsp;&nbsp; &lt;title&gt;屏蔽鼠标右键、Ctrl+N、Shift+F10、Alt+F4、F11、F5刷新、退格键&lt;/title&gt; <br />&lt;/head&gt; <br />&lt;body&gt; <br />&lt;script language=<span style="COLOR: rgb(255,0,255);">"Javascript"</span>&gt;&lt;!-- <br />&nbsp;&nbsp;<span style="COLOR: rgb(0,128,0);">//屏蔽鼠标右键、Ctrl+N、Shift+F10、F11、F5刷新、退格键 </span><br />&nbsp;&nbsp;<span style="COLOR: rgb(0,128,0);">//Author: meizz(梅花雨) 2002-6-18 </span><br /><span style="COLOR: rgb(0,0,255);">function</span> document.oncontextmenu(){event.returnValue=<span style="COLOR: rgb(0,0,255);">false</span>;}<span style="COLOR: rgb(0,128,0);">//屏蔽鼠标右键 </span><br /><span style="COLOR: rgb(0,0,255);">function</span> window.onhelp(){<span style="COLOR: rgb(0,0,255);">return</span> <span style="COLOR: rgb(0,0,255);">false</span>} <span style="COLOR: rgb(0,128,0);">//屏蔽F1帮助 </span><br /><span style="COLOR: rgb(0,0,255);">function</span> document.onkeydown() <br />{ <br />&nbsp;&nbsp;<span style="COLOR: rgb(0,0,255);">if</span> ((window.event.altKey)&amp;&amp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ((window.event.keyCode==37)||&nbsp;&nbsp;&nbsp;<span style="COLOR: rgb(0,128,0);">//屏蔽 Alt+ 方向键 &larr; </span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (window.event.keyCode==39)))&nbsp;&nbsp;&nbsp;<span style="COLOR: rgb(0,128,0);">//屏蔽 Alt+ 方向键 &rarr; </span><br />&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; alert(<span style="COLOR: rgb(255,0,255);">"不准你使用ALT+方向键前进或后退网页！"</span>); <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; event.returnValue=<span style="COLOR: rgb(0,0,255);">false</span>; <br />&nbsp;&nbsp; } <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: rgb(0,128,0);">/* 注：这还不是真正地屏蔽 Alt+ 方向键， <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 因为 Alt+ 方向键弹出警告框时，按住 Alt 键不放， <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 用鼠标点掉警告框，这种屏蔽方法就失效了。以后若 <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 有哪位高手有真正屏蔽 Alt 键的方法，请告知。*/</span> <br />&nbsp;&nbsp;<span style="COLOR: rgb(0,0,255);">if</span> ((event.keyCode==8)&nbsp;&nbsp; ||&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: rgb(0,128,0);">//屏蔽退格删除键 </span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (event.keyCode==116)||&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: rgb(0,128,0);">//屏蔽 F5 刷新键 </span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (event.ctrlKey &amp;&amp; event.keyCode==82)){ <span style="COLOR: rgb(0,128,0);">//Ctrl + R </span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; event.keyCode=0; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; event.returnValue=<span style="COLOR: rgb(0,0,255);">false</span>; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <br />&nbsp;&nbsp;<span style="COLOR: rgb(0,0,255);">if</span> (event.keyCode==122){event.keyCode=0;event.returnValue=<span style="COLOR: rgb(0,0,255);">false</span>;}&nbsp;&nbsp;<span style="COLOR: rgb(0,128,0);">//屏蔽F11 </span><br />&nbsp;&nbsp;<span style="COLOR: rgb(0,0,255);">if</span> (event.ctrlKey &amp;&amp; event.keyCode==78) event.returnValue=<span style="COLOR: rgb(0,0,255);">false</span>;&nbsp;&nbsp;&nbsp;<span style="COLOR: rgb(0,128,0);">//屏蔽 Ctrl+n </span><br />&nbsp;&nbsp;<span style="COLOR: rgb(0,0,255);">if</span> (event.shiftKey &amp;&amp; event.keyCode==121)event.returnValue=<span style="COLOR: rgb(0,0,255);">false</span>;&nbsp;&nbsp;<span style="COLOR: rgb(0,128,0);">//屏蔽 shift+F10 </span><br />&nbsp;&nbsp;<span style="COLOR: rgb(0,0,255);">if</span> (window.event.srcElement.tagName == <span style="COLOR: rgb(255,0,255);">"A"</span> &amp;&amp; window.event.shiftKey) <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; window.event.returnValue = <span style="COLOR: rgb(0,0,255);">false</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: rgb(0,128,0);">//屏蔽 shift 加鼠标左键新开一网页 </span><br />&nbsp;&nbsp;<span style="COLOR: rgb(0,0,255);">if</span> ((window.event.altKey)&amp;&amp;(window.event.keyCode==115))&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: rgb(0,128,0);">//屏蔽Alt+F4 </span><br />&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; window.showModelessDialog(<span style="COLOR: rgb(255,0,255);">"about:blank"</span>,<span style="COLOR: rgb(255,0,255);">""</span>,<span style="COLOR: rgb(255,0,255);">"dialogWidth:1px;dialogheight:1px"</span>); <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: rgb(0,0,255);">return</span> <span style="COLOR: rgb(0,0,255);">false</span>; <br />&nbsp;&nbsp; } <br />} <br />&lt;/script&gt; <br />屏蔽鼠标右键、Ctrl+N、Shift+F10、Alt+F4、F11、F5刷新、退格键 <br />&lt;/body&gt; <br />&lt;/html&gt;</div>
<p><strong>//屏蔽打印</strong> <br />&lt;style&gt; <br />@media print{ <br />* {display:none} <br />} <br />&lt;/style&gt;</p>
</font>
<p><font size="2"><strong>//移动的图层，拖动 <br /></strong></font></p>
<font size="2">
<div style="BORDER-RIGHT: rgb(138,138,138) 1px solid; PADDING-RIGHT: 4px; BORDER-TOP: rgb(138,138,138) 1px solid; PADDING-LEFT: 4px; FONT-SIZE: 12px; PADDING-BOTTOM: 4px; MARGIN: 4px; OVERFLOW: auto; BORDER-LEFT: rgb(138,138,138) 1px solid; PADDING-TOP: 4px; BORDER-BOTTOM: rgb(138,138,138) 1px solid; BACKGROUND-COLOR: rgb(238,238,238);">1.&lt;span style='position:absolute;width:200;height:200;background:red' onmousedown=MouseDown(<span style="COLOR: rgb(0,0,255);">this</span>) onmousemove=MouseMove() onmouseup=MouseUp()&gt;meizz&lt;/span&gt; <br />&lt;script language=javascript&gt; <br /><span style="COLOR: rgb(0,0,255);">var</span> Obj; <br /><span style="COLOR: rgb(0,0,255);">function</span> MouseDown(obj) <br />{ <br />&nbsp;&nbsp; Obj=obj; <br />&nbsp;&nbsp; Obj.setCapture(); <br />&nbsp;&nbsp; Obj.l=event.x-Obj.style.pixelLeft; <br />&nbsp;&nbsp; Obj.t=event.y-Obj.style.pixelTop; <br />} <br /><span style="COLOR: rgb(0,0,255);">function</span> MouseMove() <br />{ <br />&nbsp;&nbsp;<span style="COLOR: rgb(0,0,255);">if</span>(Obj!=<span style="COLOR: rgb(0,0,255);">null</span>) <br />&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp; Obj.style.left = event.x-Obj.l; <br />&nbsp;&nbsp;&nbsp;&nbsp; Obj.style.top = event.y-Obj.t; <br />&nbsp;&nbsp; } <br />} <br /><span style="COLOR: rgb(0,0,255);">function</span> MouseUp() <br />{ <br />&nbsp;&nbsp;<span style="COLOR: rgb(0,0,255);">if</span>(Obj!=<span style="COLOR: rgb(0,0,255);">null</span>) <br />&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp; Obj.releaseCapture(); <br />&nbsp;&nbsp;&nbsp;&nbsp; Obj=<span style="COLOR: rgb(0,0,255);">null</span>; <br />&nbsp;&nbsp; } <br />} <br />&lt;/script&gt; <br />2. <br />&lt;div id=<span style="COLOR: rgb(255,0,255);">"myDiv"</span> src=<span style="COLOR: rgb(255,0,255);">"logo.gif"</span> ondrag=<span style="COLOR: rgb(255,0,255);">"doDrag();"</span> onmouseover=<span style="COLOR: rgb(255,0,255);">"this.style.cursor='hand'"</span> style=<span style="COLOR: rgb(255,0,255);">"position:absolute;left=100;top=100;"</span> onmousedown=<span style="COLOR: rgb(255,0,255);">"doMouseDown();"</span>&gt; <br />&lt;a href=<span style="COLOR: rgb(255,0,255);">"#"</span> onclick=<span style="COLOR: rgb(255,0,255);">"return false"</span>&gt;&lt;h1&gt;wlecome&lt;/h1&gt;&lt;/a&gt; <br />&lt;/div&gt; <br />&lt;script language=<span style="COLOR: rgb(255,0,255);">"JavaScript"</span> type=<span style="COLOR: rgb(255,0,255);">"text/javascript"</span>&gt; <br /><span style="COLOR: rgb(0,0,255);">var</span> orgMouseX; <br /><span style="COLOR: rgb(0,0,255);">var</span> orgMouseY; <br /><span style="COLOR: rgb(0,0,255);">var</span> orgObjX; <br /><span style="COLOR: rgb(0,0,255);">var</span> orgObjY; <br /><span style="COLOR: rgb(0,0,255);">function</span> doDrag() <br />{ <br /><span style="COLOR: rgb(0,0,255);">var</span> myObject=document.all.myDiv; <br /><br /><span style="COLOR: rgb(0,0,255);">var</span> x=event.clientX; <br /><span style="COLOR: rgb(0,0,255);">var</span> y=event.clientY; <br />myObject.style.left=x-(orgMouseX-orgObjX); <br />myObject.style.top=y-(orgMouseY-orgObjY); <br /><br />} <br /><span style="COLOR: rgb(0,0,255);">function</span> doMouseDown() <br />{ <br />orgMouseX=event.clientX; <br />orgMouseY=event.clientY; <br />orgObjX=parseInt(document.all.myDiv.style.left); <br />orgObjY=parseInt(document.all.myDiv.style.top); <br />} <br /><br />&lt;/script&gt;</div>
<p><font size="2"><strong>//文档状态改变 <br /></strong></font></p>
</font><font size="2">
<div style="BORDER-RIGHT: rgb(138,138,138) 1px solid; PADDING-RIGHT: 4px; BORDER-TOP: rgb(138,138,138) 1px solid; PADDING-LEFT: 4px; FONT-SIZE: 12px; PADDING-BOTTOM: 4px; MARGIN: 4px; OVERFLOW: auto; BORDER-LEFT: rgb(138,138,138) 1px solid; PADDING-TOP: 4px; BORDER-BOTTOM: rgb(138,138,138) 1px solid; BACKGROUND-COLOR: rgb(238,238,238);">&lt;iframe src=<span style="COLOR: rgb(255,0,255);">"a.html"</span> id=<span style="COLOR: rgb(255,0,255);">"f"</span> name=<span style="COLOR: rgb(255,0,255);">"f"</span> scrolling=<span style="COLOR: rgb(255,0,255);">"no"</span> frameborder=0 marginwidth=0 marginheight=0&gt;&lt;/iframe&gt; <br />&lt;script&gt; <br /><span style="COLOR: rgb(0,0,255);">var</span> doc=window.frames[<span style="COLOR: rgb(255,0,255);">"f"</span>].document; <br /><span style="COLOR: rgb(0,0,255);">function</span> s(){ <br /><span style="COLOR: rgb(0,0,255);">if</span> (doc.readyState==<span style="COLOR: rgb(255,0,255);">"complete"</span>){ <br />&nbsp;&nbsp; document.all.f.style.height=doc.body.scrollHeight <br />&nbsp;&nbsp; document.all.f.style.width=doc.body.scrollWidth <br />} <br />} <br />doc.onreadystatechange=s <br />&lt;/script&gt;</div>
</font>
<p><font size="2"><strong>//刷新后不变的文本框</strong> </font></p>
<p>&nbsp;</p>
<p><font size="2"><strong>//访问剪贴板</strong> </font></p></div><div class="tags"></div><div class="post-nav"><a class="pre" href="/2008/06/14/217-javaScript%E6%8A%80%E5%B7%A7%E9%9B%86%E5%90%88/">javaScript技巧集合</a><a class="next" href="/2008/06/09/221-JavaScript%E8%8E%B7%E5%8F%96%E7%AA%97%E5%8F%A3%E7%9A%84%E9%AB%98%E5%BA%A6%E5%92%8C%E5%AE%BD%E5%BA%A6/">JavaScript获取窗口的高度和宽度</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="https://anthoney.github.io"/></form></div><div class="widget"><div class="author-info"><a class="info-avatar" href="/about/" title="关于"><img class="nofancybox" src="/img/avatar.png"/></a><p>To be a better man.</p><a class="info-icon" href="https://twitter.com/yontaw" title="Twitter" target="_blank" style="margin-inline:5px"> <i class="fa fa-twitter-square" style="margin-inline:5px"></i></a><a class="info-icon" href="mailto:admin@from2.net" title="Email" target="_blank" style="margin-inline:5px"> <i class="fa fa-envelope-square" style="margin-inline:5px"></i></a><a class="info-icon" href="https://github.com/anthoney" title="Github" target="_blank" style="margin-inline:5px"> <i class="fa fa-github-square" style="margin-inline:5px"></i></a><a class="info-icon" href="/atom.xml" title="RSS" target="_blank" style="margin-inline:5px"> <i class="fa fa-rss-square" style="margin-inline:5px"></i></a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/GIS/">GIS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%BA%BA%E6%96%87%E5%9C%B0%E7%90%86/">人文地理</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%90%83%E5%96%9D%E7%8E%A9%E4%B9%90/">吃喝玩乐</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%A4%96%E8%AF%AD/">外语</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%BD%B1%E9%9F%B3%E5%9B%BE%E5%BD%A2/">影音图形</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%BF%83%E8%B7%AF/">心路</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9D%82%E8%B0%88/">杂谈</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%BD%AF%E4%BB%B6%E6%8A%80%E6%9C%AF/">软件技术</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%A3%9E%E8%A1%8C%E6%A2%A6%E6%83%B3/">飞行梦想</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2021/09/30/455-FlexNet%20lmtools%20license%20vitual%20adapter%20Revit%E9%85%8D%E7%BD%AE%E8%99%9A%E6%8B%9F%E7%BD%91%E5%8D%A1/">FlexNet lmtools license vitual adapter Revit配置虚拟网卡</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/08/454-%E6%88%BF%E5%B1%8B%E5%9D%90%E5%90%91%E4%BB%A5%E4%BB%80%E4%B9%88%E4%B8%BA%E5%87%86%20%E6%88%BF%E5%B1%8B%E5%9D%90%E5%90%91%E6%80%8E%E4%B9%88%E7%9C%8B/">房屋坐向以什么为准 房屋坐向怎么看</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/01/12/453-FME%20Desktop%202021%20for%20Mac%E5%AE%89%E8%A3%85%E8%B8%A9%E5%9D%91%E6%95%99%E7%A8%8B/">FME Desktop 2021 for Mac安装踩坑教程</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04/29/452-%E4%BF%9D%E5%8F%B7google%20voice%E9%99%84%E4%BD%BF%E7%94%A8%E5%BB%BA%E8%AE%AE/">保号google voice附使用建议</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/14/451-5G%20Wifi%20Router%20Band%20Channel%20limit%E4%BF%AE%E6%94%B95GWIFI%E8%B7%AF%E7%94%B1%E4%B8%AD%E5%9B%BD%E9%A2%91%E6%AE%B5%E9%99%90%E5%88%B6/">5G Wifi Router Band Channel limit修改5GWIFI路由中国频段限制</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/22/450-%E8%80%81%E6%AC%BEiPhone%E5%8F%98%E6%85%A2%E5%8D%A1%E9%A1%BF%E6%8E%89%E5%B8%A7%E5%8F%91%E7%83%AD%E5%88%87%E6%8D%A2%E8%BF%9F%E7%BC%93%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95%E5%88%86%E4%BA%AB/">老款iPhone变慢卡顿掉帧发热切换迟缓解决方法分享</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/12/13/449-python%E4%B8%AD%E6%96%87%E5%AD%97%E7%AC%A6%E4%B9%B1%E7%A0%81%E8%A7%A3%E5%86%B3%E5%81%8F%E6%96%B9/">python中文字符乱码解决偏方</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/06/02/448-Python%20opencv%20error%20215%20imshow%20%E9%97%AE%E9%A2%98/">Python opencv error 215 imshow 问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/04/04/447-python%20faild_install_package%20%E6%8A%A5%E9%94%99%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/">python faild_install_package 报错解决办法</a></li><li class="post-list-item"><a class="post-list-link" href="/2013/06/16/446-%E5%8F%A4%E5%85%B8%E8%AF%97%E8%AF%8D/">古典诗词</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2023 <a href="/." rel="nofollow">from2.net.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.js"></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.0"></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.css"><script type="text/javascript" src="/js/copycode.js?v=1.0.0" successtext="复制成功！"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css?v=1.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>